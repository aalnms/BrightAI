<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ูุธุงู ุงูุฐูุงุก ุงูุงุตุทูุงุนู ูุงุณุชูุทุงุจ ุงูููุงูุจ - ูุดุฑูุฉ AI</title>

    <!-- Add favicon -->
    <link rel="icon" type="image/png" href="logo.png">
    <link rel="apple-touch-icon" sizes="180x180" href="logo.png">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>
    
    <style>
        :root {
            --primary-color: #667eea; /* Bootstrap primary-like */
            --secondary-color: #764ba2; /* Bootstrap secondary-like */
            --accent-color: #f093fb;
            --success-color: #10b981; /* Bootstrap success-like */
            --warning-color: #f59e0b; /* Bootstrap warning-like */
            --error-color: #ef4444;   /* Bootstrap danger-like */
            --info-color: #0dcaf0;    /* Bootstrap info-like */
            --text-primary: #1f2937;
            --text-secondary: #6b7280;
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --border-color: #e5e7eb;
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1);
            --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1);
        }

        body {
            font-family: 'Cairo', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.7;
            color: var(--text-primary);
            background-color: #f0f2f5; /* Lighter, more neutral background */
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container-fluid {
            padding-left: 30px;
            padding-right: 30px;
        }
        
        .header {
            text-align: center;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 50px 20px;
            border-radius: 15px;
            margin-bottom: 40px;
            box-shadow: var(--shadow-lg);
        }

        .header h1 {
            font-size: 2.8rem;
            margin-bottom: 15px;
            font-weight: 700;
            letter-spacing: -1px;
            color: white; /* Ensure text is white on gradient */
        }

        .header .subtitle {
            font-size: 1.25rem;
            font-weight: 400;
            color: rgba(255, 255, 255, 0.9);
        }

        .header .company-logo {
            display: inline-block;
            margin-top: 20px;
            padding: 12px 25px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border-radius: 50px;
            font-weight: 600;
            font-size: 1.1rem;
        }

        .section-card {
            background: var(--bg-primary);
            margin-bottom: 30px;
            padding: 30px;
            border-radius: 15px;
            box-shadow: var(--shadow-md);
            transition: all 0.3s ease;
            border: 1px solid var(--border-color);
        }

        .section-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .section-title {
            color: var(--text-primary);
            font-size: 1.75rem;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--primary-color);
            display: flex;
            align-items: center;
            gap: 15px;
            font-weight: 600;
        }

        .section-icon { /* Re-using for consistency if needed, or use i tags directly */
            width: 45px;
            height: 45px;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.4rem;
        }
        
        .intro-text {
            font-size: 1.1rem;
            line-height: 1.8;
            color: var(--text-secondary);
            background: var(--bg-secondary);
            padding: 25px;
            border-radius: 10px;
            border-right: 5px solid var(--primary-color);
            position: relative;
        }
        .intro-text::before {
            content: 'โ'; /* Using a more standard quote */
            position: absolute;
            top: -5px;
            right: 20px;
            font-size: 3.5rem;
            color: var(--primary-color);
            opacity: 0.2;
        }

        .upload-area {
            border: 3px dashed var(--primary-color);
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            background: var(--bg-secondary);
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        .upload-area:hover {
            background: #e9ecef; /* Light hover for Bootstrap feel */
            border-color: var(--secondary-color);
        }
        .upload-area.dragover {
            background: #dde2e6;
            border-color: var(--primary-color);
            transform: scale(1.02);
        }
        .upload-icon {
            font-size: 3.5rem;
            color: var(--primary-color);
            margin-bottom: 20px;
            animation: bounce 2s infinite; /* Keeping bounce animation */
        }
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }

        .btn { /* General btn enhancements if needed, Bootstrap handles most */
            padding: 10px 25px;
            font-weight: 600;
            font-size: 1rem;
            border-radius: 8px;
            margin: 5px; /* Bootstrap's margin utilities can also be used */
        }
        .btn-primary {
             background-color: var(--primary-color);
             border-color: var(--primary-color);
        }
        .btn-primary:hover {
             background-color: #5269d6; /* Darken primary */
             border-color: #4a5dbf;
        }
        /* Custom gradients for specific buttons if desired */
        .btn-gradient-success {
            background: linear-gradient(45deg, var(--success-color), #059669);
            color: white;
            border: none;
        }
        .btn-gradient-warning {
            background: linear-gradient(45deg, var(--warning-color), #d97706);
            color: white;
            border: none;
        }
         .btn-gradient-danger {
            background: linear-gradient(45deg, var(--error-color), #dc2626);
            color: white;
            border: none;
        }


        .input-field { /* Will be replaced by form-control mostly */
            border-radius: 8px;
        }

        .output-box { /* For general output, can be styled like a card-body */
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            min-height: 100px;
            white-space: pre-wrap; /* Changed to pre-wrap to respect line breaks from <br> */
            font-size: 1rem;
            line-height: 1.7;
        }
        .output-box h3, .output-box h4 {
            margin-top: 1.2em;
            margin-bottom: 0.6em;
            font-weight: 600;
        }
        .output-box h3 { font-size: 1.25rem; color: var(--primary-color);}
        .output-box h4 { font-size: 1.1rem; color: var(--secondary-color);}
        .output-box strong { color: var(--text-primary); }
        .output-box ul {
            list-style-type: disc;
            padding-right: 20px; /* RTL */
            margin-bottom: 10px;
        }
         .output-box li {
            margin-bottom: 5px;
        }
        
        /* New result display card */
        .analysis-result-card {
            margin-top: 20px;
            border-left: 5px solid var(--success-color);
        }
        .analysis-result-card .card-title {
            color: var(--success-color);
        }
        .analysis-result-card .list-group-item {
            background-color: var(--bg-secondary);
            border-color: var(--border-color);
        }

        .candidate-card-bs { /* Bootstrap candidate card */
            border-radius: 15px;
            padding: 25px;
        }
        .candidate-avatar {
            width: 70px;
            height: 70px;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.8rem;
            margin-bottom: 15px;
        }
        .compatibility-score {
            display: inline-block;
            padding: 10px 18px;
            border-radius: 50px;
            color: white;
            font-weight: bold;
            margin-top: 15px;
            font-size: 1rem;
        }
        .score-high { background: linear-gradient(45deg, var(--success-color), #059669); }
        .score-medium { background: linear-gradient(45deg, var(--warning-color), #d97706); }
        .score-low { background: linear-gradient(45deg, var(--error-color), #dc2626); }

        .questions-list .list-group-item {
            background: white;
            padding: 15px 20px;
            margin-bottom: 10px;
            border-radius: 8px;
            border-right: 4px solid var(--primary-color);
            box-shadow: var(--shadow-sm);
            transition: all 0.3s ease;
        }
        .questions-list .list-group-item:hover {
            transform: translateX(-5px);
            box-shadow: var(--shadow-md);
        }
        .questions-list h5 { font-weight: 600; }

        .chat-container {
            height: 350px;
            overflow-y: auto;
            background: var(--bg-secondary);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            border: 1px solid var(--border-color);
        }
        .chat-message {
            margin-bottom: 15px;
            padding: 12px 18px;
            border-radius: 12px;
            max-width: 80%;
            animation: slideIn 0.3s ease;
            line-height: 1.6;
        }
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .user-message {
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            color: white;
            margin-right: auto;
            border-bottom-right-radius: 5px;
        }
        .ai-message {
            background: white;
            border: 1px solid var(--border-color);
            margin-left: auto;
            border-bottom-left-radius: 5px;
            box-shadow: var(--shadow-sm);
        }
        .ai-message strong { color: var(--primary-color); }


        .value-points .card {
            border-right: 5px solid var(--primary-color);
            transition: all 0.3s ease;
        }
        .value-points .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }
        .value-points .card h3 {
            color: var(--text-primary);
            font-size: 1.2rem;
        }

        .loading { display: none; text-align: center; color: var(--primary-color); font-style: italic; font-size: 1rem; padding: 15px; }
        .loading.show { display: block; }
        .loading-spinner { display: inline-block; width: 25px; height: 25px; border: 3px solid rgba(102, 126, 234, 0.3); border-radius: 50%; border-top-color: var(--primary-color); animation: spin 1s ease-in-out infinite; margin-left: 8px; vertical-align: middle; }
        @keyframes spin { to { transform: rotate(360deg); } }

        .progress-bar-custom { /* Custom name to avoid conflict with Bootstrap's .progress-bar */
            width: 100%;
            height: 8px;
            background: var(--border-color);
            border-radius: 4px;
            overflow: hidden;
            margin: 15px 0;
        }
        .progress-fill-custom {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 4px;
        }
        
        .sidebar {
            background-color: var(--bg-primary);
            padding: 20px;
            border-radius: 15px;
            box-shadow: var(--shadow-md);
        }
        .sidebar h4 {
            color: var(--primary-color);
        }
        .sidebar ul li {
            padding: 8px 0;
            color: var(--text-secondary);
        }
        .sidebar ul li i {
            margin-left: 8px; /* For RTL, this should be margin-right if icons are before text */
        }

        /* Floating shapes - kept from original */
        .floating-shapes { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: -1; }
        .shape { position: absolute; opacity: 0.07; animation: float 10s ease-in-out infinite; } /* Slower animation, less opacity */
        .shape:nth-child(1) { top: 15%; left: 5%; animation-delay: 0s; width: 100px; height: 100px; background: linear-gradient(45deg, var(--primary-color), var(--secondary-color)); border-radius: 50%;}
        .shape:nth-child(2) { top: 55%; right: 8%; animation-delay: 3s; width: 80px; height: 80px; background: linear-gradient(45deg, var(--secondary-color), var(--accent-color)); border-radius: 20px;}
        .shape:nth-child(3) { bottom: 10%; left: 15%; animation-delay: 6s; width: 120px; height: 120px; background: linear-gradient(45deg, var(--accent-color), var(--primary-color)); clip-path: polygon(50% 0%, 0% 100%, 100% 100%);}
        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg) scale(1); }
            50% { transform: translateY(-25px) rotate(45deg) scale(1.05); }
        }

        /* Ensure FontAwesome icons are vertically aligned with text */
        .fas, .far, .fal, .fab {
            vertical-align: middle;
        }
        .section-title .fas {
            margin-left: 10px; /* Adjust for RTL if icon is after title */
        }
        
        /* Alert styling */
        .alert {
            padding: 1rem; /* Bootstrap default, can adjust */
        }
        .alert-success-custom {
            background-color: #d1e7dd; /* Bootstrap success background */
            color: #0f5132; /* Bootstrap success text */
            border-color: #badbcc; /* Bootstrap success border */
        }
        .alert-danger-custom {
            background-color: #f8d7da; /* Bootstrap danger background */
            color: #842029; /* Bootstrap danger text */
            border-color: #f5c2c7; /* Bootstrap danger border */
        }
        
        /* Voice controls adjustments */
        .voice-controls .btn {
            margin: 5px;
        }
        .voice-status {
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
            border: 2px solid transparent;
        }
        .status-listening {
            background: linear-gradient(45deg, #dcfce7, #bbf7d0);
            color: var(--success-color);
            border-color: var(--success-color);
        }
        .status-stopped {
            background: linear-gradient(45deg, #fef3c7, #fde68a);
            color: var(--warning-color);
            border-color: var(--warning-color);
        }
         .audio-wave {
            display: none;
            width: 50px; /* Slightly smaller */
            height: 35px;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 40"><rect x="5" y="15" width="4" height="10" fill="%23667eea"><animate attributeName="height" values="10;25;10" dur="0.8s" repeatCount="indefinite"/></rect><rect x="15" y="10" width="4" height="20" fill="%23667eea"><animate attributeName="height" values="20;35;20" dur="0.8s" repeatCount="indefinite" begin="0.2s"/></rect><rect x="25" y="12" width="4" height="16" fill="%23667eea"><animate attributeName="height" values="16;30;16" dur="0.8s" repeatCount="indefinite" begin="0.4s"/></rect><rect x="35" y="8" width="4" height="24" fill="%23667eea"><animate attributeName="height" values="24;32;24" dur="0.8s" repeatCount="indefinite" begin="0.6s"/></rect><rect x="45" y="14" width="4" height="12" fill="%23667eea"><animate attributeName="height" values="12;22;12" dur="0.8s" repeatCount="indefinite" begin="0.8s"/></rect></svg>') no-repeat center;
            background-size: contain;
        }
        .audio-wave.show {
            display: inline-block;
        }


    </style>
</head>
<body>
    <div class="floating-shapes">
        <div class="shape"></div>
        <div class="shape"></div>
        <div class="shape"></div>
    </div>

    <div class="container-fluid py-4">
        <!-- Header -->
        <div class="header">
            <h1><i class="fas fa-brain me-2"></i>ูุธุงู ุงูุฐูุงุก ุงูุงุตุทูุงุนู ูุงุณุชูุทุงุจ ุงูููุงูุจ</h1>
            <p class="subtitle">ุญููู ูุชูุฏูุฉ ููุชูุธูู ุงูุฐูู ูู ุงูุฌูุงุช ุงูุญููููุฉ</p>
            <div class="company-logo">
                <i class="fas fa-building me-1"></i> ูุดุฑูุฉ AI
            </div>
        </div>

        <div class="row">
            <!-- Sidebar -->
            <div class="col-lg-3 order-lg-last mb-4 mb-lg-0">
                <div class="sidebar sticky-top" style="top: 20px;">
                    <h4 class="mb-3"><i class="fas fa-star me-2"></i> ููุงุฆุฏ ุงููุธุงู ุงูุฃุณุงุณูุฉ</h4>
                    <ul class="list-unstyled">
                        <li class="mb-2"><i class="fas fa-tachometer-alt text-success fa-fw me-2"></i> ูููุฑ ูุง ูุตู ุฅูู <strong>67%</strong> ูู ููุช ุงูููุธู ุงูุฅุฏุงุฑู.</li>
                        <li class="mb-2"><i class="fas fa-users-cog text-info fa-fw me-2"></i> ุชุนุฒูุฒ ุฏูุฉ ุงุฎุชูุงุฑ ุงููุฑุดุญูู ุจูุณุจุฉ ุนุงููุฉ.</li>
                        <li class="mb-2"><i class="fas fa-chart-line text-warning fa-fw me-2"></i> ุชุญุณูู ุชุฌุฑุจุฉ ุงูุชูุฏูู ูููุฑุดุญูู ูุงูููุธููู.</li>
                        <li class="mb-2"><i class="fas fa-dollar-sign text-danger fa-fw me-2"></i> ุชูููู ุชูุงููู ุงูุชูุธูู ุจุดูู ููุญูุธ.</li>
                        <li class="mb-2"><i class="fas fa-balance-scale text-primary fa-fw me-2"></i> ุถูุงู ุงูููุถูุนูุฉ ูุงูุญูุงุฏ ูู ุงูุชูููู.</li>
                         <li class="mb-2"><i class="fas fa-microphone-alt text-secondary fa-fw me-2"></i> ููุงุจูุงุช ุตูุชูุฉ ุฐููุฉ ุจุงููุบุฉ ุงูุนุฑุจูุฉ.</li>
                    </ul>
                    <hr>
                    <p class="text-muted small">ูุธุงู ูุดุฑูุฉ AI: ูุญู ูุณุชูุจู ุชูุธูู ุฃูุซุฑ ุฐูุงุกู ูููุงุกุฉ.</p>
                </div>
            </div>

            <!-- Main Content -->
            <div class="col-lg-9 order-lg-first">
                <!-- ุงููุณู ุงูุฃูู: ุชุนุฑูู ุงููุธุงู -->
                <div class="section-card card">
                    <div class="card-body">
                        <h2 class="section-title">
                            <span class="section-icon"><i class="fas fa-info-circle"></i></span>
                            ุชุนุฑูู ุงููุธุงู
                        </h2>
                        <div class="intro-text">
                            ูุธุงู ุงูุฐูุงุก ุงูุงุตุทูุงุนู ุงูุฎุงุต ุจูุง ูู ุญู ุชููู ูุชูุฏู ูุตูู ูุชุญููู ุนูููุงุช ุงุณุชูุทุงุจ ุงูููุงูุจ ูู ุงูุฌูุงุช ุงูุญููููุฉ ุฅูู ุนูููุงุช ุฐููุฉุ ูุคุชูุชุฉุ ูุณุฑูุนุฉ. ูุนุชูุฏ ุงููุธุงู ุนูู ูุฏุฑุงุช ูุชูุฏูุฉ ูู ุชุญููู ุงูุจูุงูุงุชุ ุงูุชูุจุคุ ูุชูููุฏ ุงููุญุชููุ ุจุงูุฅุถุงูุฉ ุฅูู ุฅุฌุฑุงุก ููุงุจูุงุช ูุจุฏุฆูุฉ ุจูุธุงู ุตูุชู ุฐูู ุจุงููุบุฉ ุงูุนุฑุจูุฉ ููุณุงุนุฏุฉ ูุฑู ุงูููุงุฑุฏ ุงูุจุดุฑูุฉ ุนูู ุงุชุฎุงุฐ ูุฑุงุฑุงุช ุฏูููุฉ ุจููุงุกุฉ ุฃุนูู ูููุถูุนูุฉ ุชุงูุฉ.
                        </div>
                    </div>
                </div>

                <!-- ุงููุณู ุงูุซุงูู: ุงุณุชูุจุงู ุงูุณูุฑ ุงูุฐุงุชูุฉ -->
                <div class="section-card card">
                    <div class="card-body">
                        <h2 class="section-title">
                            <span class="section-icon"><i class="fas fa-file-upload"></i></span>
                            ุงุณุชูุจุงู ูุชุญููู ุงูุณูุฑ ุงูุฐุงุชูุฉ
                        </h2>
                        <div class="upload-area mb-3" id="uploadArea">
                            <div class="upload-icon">
                                <i class="fas fa-cloud-upload-alt"></i>
                            </div>
                            <p style="font-size: 1.1rem; margin-bottom: 10px;" id="uploadAreaText">ุงุณุญุจ ูุฃููุช ุงูุณูุฑุฉ ุงูุฐุงุชูุฉ ููุง ุฃู ุงููุฑ ููุงุฎุชูุงุฑ</p>
                            <p class="text-muted small">ูุฏุนู ูููุงุช PDF ู Word (ุญุชู 10 ููุฌุงุจุงูุช)</p>
                            <input type="file" id="resumeFile" accept=".pdf,.doc,.docx" class="d-none">
                        </div>
                        <button class="btn btn-primary" onclick="document.getElementById('resumeFile').click()">
                            <i class="fas fa-folder-open me-2"></i> ุงุฎุชูุงุฑ ููู ุงูุณูุฑุฉ ุงูุฐุงุชูุฉ
                        </button>
                        
                        <div class="file-info mt-3 p-3 border rounded bg-light" id="fileInfo" style="display: none;">
                            <h5 class="mb-2"><i class="fas fa-file-alt me-2 text-primary"></i> ูุนูููุงุช ุงูููู:</h5>
                            <div class="row">
                                <div class="col-md-4"><small><strong>ุงุณู ุงูููู:</strong> <span id="fileName">-</span></small></div>
                                <div class="col-md-4"><small><strong>ุญุฌู ุงูููู:</strong> <span id="fileSize">-</span></small></div>
                                <div class="col-md-4"><small><strong>ููุน ุงูููู:</strong> <span id="fileType">-</span></small></div>
                            </div>
                        </div>

                        <div class="alert alert-danger-custom mt-3" id="errorMessage" style="display: none;"></div>
                        <div class="alert alert-success-custom mt-3" id="successMessage" style="display: none;"></div>

                        <button class="btn btn-gradient-success mt-3" id="analyzeResumeBtn" onclick="analyzeResume()" disabled>
                            <i class="fas fa-brain me-2"></i> ุชุญููู ุงูุณูุฑุฉ ุงูุฐุงุชูุฉ ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู
                        </button>
                        
                        <div class="loading mt-3" id="resumeLoading">
                            <i class="fas fa-cog fa-spin me-1"></i> ุฌุงุฑู ุชุญููู ุงูุณูุฑุฉ ุงูุฐุงุชูุฉ...
                            <div class="loading-spinner"></div>
                        </div>
                        
                        <div class="progress-bar-custom mt-3" id="progressBar" style="display: none;">
                            <div class="progress-fill-custom" id="progressFill"></div>
                        </div>
                        
                        <!-- Enhanced Result Display -->
                        <div class="card analysis-result-card mt-3" id="analysisResultCard" style="display: none;">
                            <div class="card-body">
                                <h5 class="card-title mb-3"><i class="fas fa-check-circle me-2"></i> ุชู ุชุญููู ุงูููู ุจูุฌุงุญ!</h5>
                                <ul class="list-group list-group-flush">
                                    <li class="list-group-item"><strong><i class="fas fa-file-signature me-2 text-primary"></i> ุงุณู ุงูููู:</strong> <span id="resultFileNameDisplay">-</span></li>
                                    <li class="list-group-item"><strong><i class="fas fa-info-circle me-2 text-info"></i> ูุนูููุงุช ูุณุชุฎุฑุฌุฉ:</strong> <span id="resultInfoCountDisplay">-</span> ููุงุท ุฑุฆูุณูุฉ.</li>
                                    <li class="list-group-item"><strong><i class="fas fa-star me-2 text-warning"></i> ุชูููู ุฃููู:</strong> <span id="resultClassificationDisplay">-</span></li>
                                </ul>
                                <button class="btn btn-outline-primary btn-sm mt-3" data-bs-toggle="collapse" href="#fullAnalysisDetails" role="button" aria-expanded="false" aria-controls="fullAnalysisDetails">
                                    ุนุฑุถ ุงูุชุญููู ุงููุงูู <i class="fas fa-chevron-down ms-1"></i>
                                </button>
                                <div class="collapse mt-2" id="fullAnalysisDetails">
                                    <div class="output-box" id="resumeOutput"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ุงููุณู ุงูุซุงูุซ: ุชูููู ุงููุฑุดุญูู -->
                <div class="section-card card">
                    <div class="card-body">
                        <h2 class="section-title">
                            <span class="section-icon"><i class="fas fa-user-check"></i></span>
                            ุชูููู ุงููุฑุดุญูู
                        </h2>
                        <div class="card candidate-card-bs" id="candidateCard" style="display: none;">
                             <div class="d-flex align-items-center mb-3">
                                <div class="candidate-avatar me-3">
                                    <i class="fas fa-user"></i>
                                </div>
                                <h3 id="candidateName" class="mb-0" style="color: var(--text-primary);">ุงุณู ุงููุฑุดุญ</h3>
                            </div>
                            <div class="row g-3 mb-3">
                                <div class="col-md-6"><p><i class="fas fa-birthday-cake me-2 text-primary"></i><strong>ุงูุนูุฑ:</strong> <span id="candidateAge">-</span></p></div>
                                <div class="col-md-6"><p><i class="fas fa-graduation-cap me-2 text-primary"></i><strong>ุงููุคูู:</strong> <span id="candidateQualification">-</span></p></div>
                                <div class="col-md-6"><p><i class="fas fa-briefcase me-2 text-primary"></i><strong>ุงูุฎุจุฑุฉ:</strong> <span id="candidateExperience">-</span></p></div>
                                <div class="col-md-6"><p><i class="fas fa-map-marker-alt me-2 text-primary"></i><strong>ุงููููุน:</strong> <span id="candidateLocation">-</span></p></div>
                            </div>
                            <button class="btn btn-gradient-warning" onclick="evaluateCandidate()">
                                <i class="fas fa-chart-line me-2"></i> ุชุญููู ุงูุฐูุงุก ุงูุงุตุทูุงุนู ุงููุชูุฏู
                            </button>
                            <div class="loading mt-3" id="evaluationLoading">
                                <i class="fas fa-brain fa-spin me-1"></i> ุฌุงุฑู ุชูููู ุงููุฑุดุญ ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู...
                                <div class="loading-spinner"></div>
                            </div>
                            <div id="evaluationResult" class="mt-3"></div>
                        </div>
                    </div>
                </div>

                <!-- ุงููุณู ุงูุฑุงุจุน: ุชูููุฏ ุฃุณุฆูุฉ ุงูููุงุจูุงุช -->
                <div class="section-card card">
                    <div class="card-body">
                        <h2 class="section-title">
                           <span class="section-icon"><i class="fas fa-question-circle"></i></span>
                            ุชูููุฏ ุฃุณุฆูุฉ ุงูููุงุจูุงุช ุงููุฎุตุตุฉ
                        </h2>
                        <textarea class="form-control input-field mb-3" id="jobDescription" placeholder="ุฃุฏุฎู ูุตู ุงููุธููุฉ ุฃู ุงููุชุทูุจุงุช ุงููุญุฏุฏุฉ ููููุตุจ..." rows="5"></textarea>
                        <button class="btn btn-primary" onclick="generateQuestions()">
                            <i class="fas fa-magic me-2"></i> ุชูููุฏ ุงูุฃุณุฆูุฉ ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู
                        </button>
                        <div class="loading mt-3" id="questionsLoading">
                            <i class="fas fa-lightbulb fa-spin me-1"></i> ุฌุงุฑู ุชูููุฏ ุฃุณุฆูุฉ ูุฎุตุตุฉ...
                            <div class="loading-spinner"></div>
                        </div>
                        <div class="output-box mt-3" id="questionsListOutput" style="display:none;">
                            <h5 class="mb-3 text-primary"><i class="fas fa-list-ul me-2"></i> ุงูุฃุณุฆูุฉ ุงููููุฏุฉ:</h5>
                            <div id="questionsList"></div>
                        </div>
                    </div>
                </div>

                <!-- ุงููุณู ุงูุฎุงูุณ: ุงูููุงุจูุงุช ุงูุตูุชูุฉ -->
                <div class="section-card card">
                     <div class="card-body">
                        <h2 class="section-title">
                            <span class="section-icon"><i class="fas fa-microphone"></i></span>
                            ุงูููุงุจูุงุช ุงูุตูุชูุฉ ุงููุจุฏุฆูุฉ
                        </h2>
                        <p class="mb-3 text-muted">
                            <i class="fas fa-info-circle me-1 text-primary"></i> ูููู ูููุชูุฏู ุฅุฌุฑุงุก ููุงุจูุฉ ูุจุฏุฆูุฉ ุชูุงุนููุฉ ุจุงูุตูุช ุจุงููุบุฉ ุงูุนุฑุจูุฉ ูุน ูุธุงู ุงูุฐูุงุก ุงูุงุตุทูุงุนู.
                        </p>
                        
                        <div class="voice-controls d-flex flex-wrap align-items-center mb-3">
                            <button class="btn btn-success me-2 mb-2" id="startInterviewBtn" onclick="startVoiceInterview()">
                                <i class="fas fa-play me-1"></i> ุจุฏุก ุงูููุงุจูุฉ
                            </button>
                            <button class="btn btn-danger me-2 mb-2" id="stopInterviewBtn" onclick="stopVoiceInterview()" disabled>
                                <i class="fas fa-stop me-1"></i> ุฅููุงู ุงูููุงุจูุฉ
                            </button>
                            <div class="voice-status me-2 mb-2" id="voiceStatus">
                                <i class="fas fa-microphone-slash me-1"></i> ุบูุฑ ูุดุท
                            </div>
                            <div class="audio-wave mb-2" id="audioWave"></div>
                        </div>
                        
                        <div class="chat-container" id="voiceChat">
                            <div class="ai-message">
                                <i class="fas fa-robot me-1"></i> ูุฑุญุจุงู ุจู ูู ุงูููุงุจูุฉ ุงููุจุฏุฆูุฉ ุงูุฐููุฉ. ุณุฃุทุฑุญ ุนููู ุจุนุถ ุงูุฃุณุฆูุฉ ุงูุนุงูุฉ ูุชูููู ูุคููุงุชู. ุชุญุฏุซ ุจูุถูุญ ูุณุฃููู ุจุงูุงุณุชูุงุน ุฅููู ูุชุญููู ุฅุฌุงุจุงุชู.
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ุงููุณู ุงูุณุงุฏุณ: ุงููุณุงุนุฏ ุงูุฐูู ุงูุชูุงุนูู -->
                <div class="section-card card">
                    <div class="card-body">
                        <h2 class="section-title">
                            <span class="section-icon"><i class="fas fa-robot"></i></span>
                            ุงููุณุงุนุฏ ุงูุฐูู ุงูุชูุงุนูู
                        </h2>
                        <div class="chat-container" id="chatContainer">
                            <div class="ai-message">
                                <i class="fas fa-robot me-1"></i> ูุฑุญุจุงู! ุฃูุง ุงููุณุงุนุฏ ุงูุฐูู ุงููุชุฎุตุต ูู ุฃูุธูุฉ ุงูุชูุธูู ูุงูููุงุฑุฏ ุงูุจุดุฑูุฉ. ููู ูููููู ูุณุงุนุฏุชู ุงููููุ
                            </div>
                        </div>
                        <div class="d-flex gap-2 mt-3">
                            <input type="text" class="form-control input-field" id="chatInput" placeholder="ุงูุชุจ ุงุณุชูุณุงุฑู ููุง...">
                            <button class="btn btn-primary" onclick="sendChatMessage()">
                                <i class="fas fa-paper-plane me-1"></i> ุฅุฑุณุงู
                            </button>
                        </div>
                    </div>
                </div>

                <!-- ุงููุณู ุงูุณุงุจุน: ุชูุฎูุต ุงููุฑุดุญ ูุงูุชูุตูุฉ ุงูููุงุฆูุฉ -->
                <div class="section-card card">
                    <div class="card-body">
                        <h2 class="section-title">
                            <span class="section-icon"><i class="fas fa-clipboard-check"></i></span>
                            ุชูุฎูุต ุงููุฑุดุญ ูุงูุชูุตูุฉ ุงูููุงุฆูุฉ
                        </h2>
                        <button class="btn btn-gradient-warning" onclick="generateRecommendation()">
                            <i class="fas fa-file-contract me-2"></i> ุชูููุฏ ุงูุชูุตูุฉ ุงูููุงุฆูุฉ
                        </button>
                        <div class="loading mt-3" id="recommendationLoading">
                            <i class="fas fa-chart-pie fa-spin me-1"></i> ุฌุงุฑู ุฅุนุฏุงุฏ ุงูุชูุฑูุฑ ุงูููุงุฆู...
                            <div class="loading-spinner"></div>
                        </div>
                        <div class="output-box mt-3" id="recommendationOutput"></div>
                    </div>
                </div>

                <!-- ุงููุณู ุงูุซุงูู: ุงููููุฉ ุงููุถุงูุฉ ูููุธุงู -->
                <div class="section-card card">
                    <div class="card-body">
                        <h2 class="section-title">
                            <span class="section-icon"><i class="fas fa-gem"></i></span>
                            ุงููููุฉ ุงููุถุงูุฉ ูููุธุงู
                        </h2>
                        <div class="row g-4 value-points">
                            <div class="col-md-6 col-lg-4">
                                <div class="card h-100">
                                    <div class="card-body text-center">
                                        <i class="fas fa-rocket fa-2x text-primary mb-2"></i>
                                        <h3 class="h5">ุชุณุฑูุน ุนูููุฉ ุงูุชูุธูู</h3>
                                        <p class="small text-muted">ุชูููู ููุช ุงููุฑุงุฌุนุฉ ูู ุฃุณุงุจูุน ุฅูู ุณุงุนุงุช ูุน ุฏูุฉ ุนุงููุฉ.</p>
                                    </div>
                                </div>
                            </div>
                             <div class="col-md-6 col-lg-4">
                                <div class="card h-100">
                                    <div class="card-body text-center">
                                        <i class="fas fa-coins fa-2x text-success mb-2"></i>
                                        <h3 class="h5">ุชูููู ุงูุชูุงููู</h3>
                                        <p class="small text-muted">ุชูููุฑ ูุจูุฑ ูู ุชูุงููู ุงูููุงุฑุฏ ุงูุจุดุฑูุฉ ูุงูููุช ูุงูุฌูุฏ.</p>
                                    </div>
                                </div>
                            </div>
                             <div class="col-md-6 col-lg-4">
                                <div class="card h-100">
                                    <div class="card-body text-center">
                                        <i class="fas fa-balance-scale fa-2x text-warning mb-2"></i>
                                        <h3 class="h5">ุชูุตูุงุช ูุญุงูุฏุฉ</h3>
                                        <p class="small text-muted">ูุฑุงุฑุงุช ููุถูุนูุฉ ุจูุงุกู ุนูู ุงูุจูุงูุงุช ูุงูุชุญููู ุงูุนููู.</p>
                                    </div>
                                </div>
                            </div>
                             <div class="col-md-6 col-lg-4">
                                <div class="card h-100">
                                    <div class="card-body text-center">
                                        <i class="fas fa-chart-bar fa-2x text-info mb-2"></i>
                                        <h3 class="h5">ุชูุงุฑูุฑ ุฐููุฉ</h3>
                                        <p class="small text-muted">ุชูุงุฑูุฑ ุชูุตูููุฉ ูุชุญููููุฉ ุฌุงูุฒุฉ ูุตุงุญุจ ุงููุฑุงุฑ.</p>
                                    </div>
                                </div>
                            </div>
                             <div class="col-md-6 col-lg-4">
                                <div class="card h-100">
                                    <div class="card-body text-center">
                                        <i class="fas fa-smile fa-2x text-secondary mb-2"></i>
                                        <h3 class="h5">ุชุญุณูู ุงูุชุฌุฑุจุฉ</h3>
                                        <p class="small text-muted">ุชุฌุฑุจุฉ ูุญุณูุฉ ูููุชูุฏููู ูุงูููุธููู ุนูู ุญุฏ ุณูุงุก.</p>
                                    </div>
                                </div>
                            </div>
                             <div class="col-md-6 col-lg-4">
                                <div class="card h-100">
                                    <div class="card-body text-center">
                                        <i class="fas fa-microphone-alt fa-2x" style="color: var(--accent-color);" mb-2></i>
                                        <h3 class="h5">ููุงุจูุงุช ุตูุชูุฉ ุฐููุฉ</h3>
                                        <p class="small text-muted">ุชูููู ูุจุฏุฆู ุชูุงุนูู ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู ุจุงููุบุฉ ุงูุนุฑุจูุฉ.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div> <!-- End Main Content Col -->
        </div> <!-- End Row -->
    </div> <!-- End Container Fluid -->

    <!-- Bootstrap JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script>
        // Gemini API Configuration
        const GEMINI_API_KEY = 'AIzaSyAquNVYw6VOmAKTtKtTPU7Tl3PVIG0sKhg'; // ุงุณุชุฎุฏู ููุชุงุญ API ุงูุฎุงุต ุจู ููุง - Note: This is a placeholder/example key.
        const GEMINI_API_URL = 'https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent';

        // Global variables
        let currentCandidate = null;
        let recognition = null;
        let isInterviewActive = false;
        let interviewQuestions = [ // Default questions, can be augmented by generated ones
            "ุญุฏุซูู ุนู ููุณู ูุฎุจุฑุงุชู ุงูููููุฉ ุจุดูู ูุฎุชุตุฑ.",
            "ูุง ูู ููุงุท ููุชู ุงูุฑุฆูุณูุฉ ุงูุชู ุชููุฒู ุนู ุงููุฑุดุญูู ุงูุขุฎุฑููุ",
            "ููุงุฐุง ุชุฑูุฏ ุงูุนูู ูู ุงููุทุงุน ุงูุญูููู ุชุญุฏูุฏุงูุ",
            "ููู ุชุชุนุงูู ูุน ุถุบุท ุงูุนูู ูุงูููุงุนูุฏ ุงูููุงุฆูุฉ ุงูุถููุฉุ",
            "ูุง ูู ุฃูุฏุงูู ุงูููููุฉ ููุณููุงุช ุงููุงุฏูุฉุ",
            "ุงุฐูุฑ ููููุงู ูุงุฌูุช ููู ุชุญุฏูุงู ูู ุงูุนูู ูููู ุชุนุงููุช ูุนู."
        ];
        let currentQuestionIndex = 0;

        const SYSTEM_PROMPTS = {
            resumeAnalysis: `ุฃูุช ูุญูู ุณูุฑ ุฐุงุชูุฉ ุฎุจูุฑ ูุชุฎุตุต ูู ุงูุชูุธูู ุงูุญูููู. ูู ุจุชุญููู ุงูุณูุฑุฉ ุงูุฐุงุชูุฉ ุงููุฑููุฉ ุจุฏูุฉ ุนุงููุฉ ูุงุณุชุฎุฑุฌ ุงููุนูููุงุช ุงูุชุงููุฉ ุจุชูุณูู ููุธู ููููู ุจุงุณุชุฎุฏุงู Markdown ุงูุฃุณุงุณู (ูุซู **ูููุต ุงูุบุงูู**ุ ูููุงุฆู ููุทูุฉ ุจุงุณุชุฎุฏุงู - ุฃู *ุ ูุนูุงููู ุจุงุณุชุฎุฏุงู ###).

            ### ๐ ุงููุนูููุงุช ุงูุดุฎุตูุฉ
            - **ุงูุงุณู ุงููุงูู:** [ุงุณุชุฎุฑุฌู ููุง]
            - **ุงูุนูุฑ (ุฅุฐุง ูุชููุฑ):** [ุงุณุชุฎุฑุฌู ููุงุ ุฃู ุงุฐูุฑ "ุบูุฑ ูุชููุฑ"]
            - **ุงูุฌูุณูุฉ:** [ุงุณุชุฎุฑุฌูุง ููุง]
            - **ููุงู ุงูุฅูุงูุฉ ุงูุญุงูู:** [ุงุณุชุฎุฑุฌู ููุง]
            - **ูุนูููุงุช ุงูุงุชุตุงู (ูุงุชู/ุจุฑูุฏ ุฅููุชุฑููู):** [ุงุณุชุฎุฑุฌูุง ููุง]

            ### ๐ ุงููุคููุงุช ุงูุชุนููููุฉ
            - **ุฃุนูู ูุคูู:** [ุงูุฏุฑุฌุฉ ุงูุนูููุฉ] ูู [ุงูุชุฎุตุต] - [ุงุณู ุงูุฌุงูุนุฉ/ุงููุนูุฏ] ([ุณูุฉ ุงูุชุฎุฑุฌ])
            - **ูุคููุงุช ุฃุฎุฑู (ุฅู ูุฌุฏุช):** 
              - [ูุคูู 1]
              - [ูุคูู 2]
            - **ุงููุนุฏู ุงูุชุฑุงููู (ุฅุฐุง ูุชููุฑ ูููู):** [ุงุณุชุฎุฑุฌู ููุงุ ุฃู "ุบูุฑ ูุชููุฑ"]

            ### ๐ผ ุงูุฎุจุฑุฉ ุงูููููุฉ
            - **ุฅุฌูุงูู ุณููุงุช ุงูุฎุจุฑุฉ:** [ุงุณุชุฎุฑุฌู ููุงุ ูุซุงู: 5 ุณููุงุช]
            - **ุงูููุตุจ ุงูุญุงูู/ุงูุฃุฎูุฑ:** **[ุงูููุตุจ]** ูู **[ุงุณู ุงูุดุฑูุฉ/ุงููุคุณุณุฉ]** (ูู [ุชุงุฑูุฎ ุงูุจุฏุก] ุฅูู [ุชุงุฑูุฎ ุงูุงูุชูุงุก/ุญุชู ุงูุขู])
              - *ุฃูู ุงููุณุคูููุงุช ูุงูุฅูุฌุงุฒุงุช:* 
                - [ุฅูุฌุงุฒ/ูุณุคูููุฉ 1]
                - [ุฅูุฌุงุฒ/ูุณุคูููุฉ 2]
            - **ููุงุตุจ ุณุงุจูุฉ ุฐุงุช ุตูุฉ (ุฅู ูุฌุฏุช):**
              - **[ุงูููุตุจ ุงูุณุงุจู]** ูู **[ุงุณู ุงูุดุฑูุฉ/ุงููุคุณุณุฉ ุงูุณุงุจูุฉ]** ([ูุชุฑุฉ ุงูุนูู])
                - *ุฅูุฌุงุฒ ุฑุฆูุณู:* [ูุตู ููุฌุฒ]

            ### ๐๏ธ ุงูููุงุฑุงุช ูุงูููุงุกุงุช
            - **ุงูููุงุฑุงุช ุงูุชูููุฉ (Hard Skills):**
                - [ููุงุฑุฉ 1]
                - [ููุงุฑุฉ 2]
                - [ููุงุฑุฉ 3]
            - **ุงูููุงุฑุงุช ุงูุดุฎุตูุฉ (Soft Skills):**
                - [ููุงุฑุฉ 1]
                - [ููุงุฑุฉ 2]
                - [ููุงุฑุฉ 3]
            - **ุงููุบุงุช:**
                - ุงูุนุฑุจูุฉ: (ูุบุฉ ุฃู / ูุชูุฏู / ูุชูุณุท / ูุจุชุฏุฆ)
                - ุงูุฅูุฌููุฒูุฉ: (ูุชูุฏู / ูุชูุณุท / ูุจุชุฏุฆ)
                - [ูุบุฉ ุฃุฎุฑู]: (ูุณุชูู ุงูุฅุฌุงุฏุฉ)
            - **ุงูุดูุงุฏุงุช ุงูููููุฉ ูุงูุฏูุฑุงุช ุงูุชุฏุฑูุจูุฉ:**
                - [ุดูุงุฏุฉ/ุฏูุฑุฉ 1]
                - [ุดูุงุฏุฉ/ุฏูุฑุฉ 2]

            ### โญ ููุงุท ุงูููุฉ ูุงููููุฒุงุช ุงูุชูุงูุณูุฉ
            - [ููุทุฉ ููุฉ ุจุงุฑุฒุฉ 1 ูุดุชูุฉ ูู ุงูุณูุฑุฉ ุงูุฐุงุชูุฉ]
            - [ููุทุฉ ููุฉ ุจุงุฑุฒุฉ 2 ูุดุชูุฉ ูู ุงูุณูุฑุฉ ุงูุฐุงุชูุฉ]
            - [ุฎุจุฑุฉ ูุชุฎุตุตุฉ ุฃู ููุฒุฉ ุชูุงูุณูุฉ ูุฑูุฏุฉ]

            ### ๐ ููุฎุต ูููู ูุชูููู ุฃููู
            - **ุชูููู ุนุงู ูููุฑุดุญ:** [ุงูุชุจ ุชูููููุง ููุฌุฒูุง ููููููุง ููุง (2-3 ุฌูู) ููุฎุต ุงูุทุจุงุนู ุงูุนุงู ุนู ูุฏู ููุฉ ุงูุณูุฑุฉ ุงูุฐุงุชูุฉ.]
            - **ูุฏู ููุงุกูุชู ุงููุจุฏุฆูุฉ ููุนูู ุงูุญูููู:** [ุจูุงุกู ุนูู ุงููุนูููุงุช ุงููุชููุฑุฉุ ูุฏู ุชูููููุง ููุฌุฒูุง ุญูู ูุฏู ุชูุงูู ุงููุฑุดุญ ูุน ุจูุฆุฉ ุงูุนูู ุงูุญููููุฉ.]
            - **ุงูุชูุตูุฉ ุงูุฃูููุฉ:** [ูุซุงู: "ูุฑุดุญ ูุงุนุฏ ุฌุฏูุง ูููุฑุญูุฉ ุงูุชุงููุฉ"ุ "ูุฑุดุญ ุฌูุฏ ูุชุทูุจ ูุฑุงุฌุนุฉ ูุจุนุถ ุงูุฌูุงูุจ"ุ "ูุฏ ูููู ููุงุณุจูุง ููุธุงุฆู ุฃุฎุฑู ุฐุงุช ูุชุทูุจุงุช X"]
            - **ุนุฏุฏ ุงูููุงุท ุงูุฑุฆูุณูุฉ ุงููุณุชุฎุฑุฌุฉ:** [ุฑูู ุชูุฑูุจู ูุนุฏุฏ ุงููุนูููุงุช ุงููุงูุฉ ุงูุชู ุชู ุงุณุชุฎูุงุตูุง]

            **ููุงุญุธุฉ ูุงูุฉ:** ูุฌุจ ุฃู ูููู ุงูุฑุฏ ุจุงููุบุฉ ุงูุนุฑุจูุฉ ุงููุตุญูุ ูููููุงุ ูููุธููุง ุจุดูู ูุงุถุญ ุจุงุณุชุฎุฏุงู ุงูุชูุณููุงุช ุงููุทููุจุฉ. ุชุฃูุฏ ูู ุงุณุชุฎุฑุงุฌ ุงููุนูููุงุช ุจุฏูุฉ. ุฅุฐุง ูุงูุช ูุนูููุฉ ุบูุฑ ูุชููุฑุฉ ุจุดูู ุตุฑูุญุ ุงุฐูุฑ "ุบูุฑ ูุชููุฑ" ุฃู "ูู ูุฐูุฑ".`,
            
            candidateEvaluation: `ุฃูุช ุฎุจูุฑ ุชูููู ูุฑุดุญูู ูุชุฎุตุต ูู ุงูุชูุธูู ููุฌูุงุช ุงูุญููููุฉ. ุจูุงุกู ุนูู ุจูุงูุงุช ุงููุฑุดุญ ุงูููุฏูุฉ (ุงูุชู ุชุดูู ุชุญููู ุณูุฑุชู ุงูุฐุงุชูุฉ)ุ ูู ุจุฅุฌุฑุงุก ุชูููู ุดุงูู ูููุตู ุจุงุณุชุฎุฏุงู Markdown ุงูุฃุณุงุณู.

            ### ๐ฏ ุชูููู ุงูุชูุงูู ูุน ุงููุชุทูุจุงุช ุงููุธูููุฉ (ุงูุชุฑุงุถูุฉ ุฃู ุนุงูุฉ ูููุทุงุน ุงูุญูููู)
            - **ูุณุจุฉ ุงูุชูุงูู ุงูุฅุฌูุงููุฉ ุงูููุฏุฑุฉ:** [ุถุน ูุณุจุฉ ูุฆููุฉ ููุงุ ูุซุงู: **85%**]
            - **ูุจุฑุฑุงุช ุงููุณุจุฉ:** [ุงุดุฑุญ ุจุฅูุฌุงุฒ ููู ูุตูุช ููุฐู ุงููุณุจุฉ ุจูุงุกู ุนูู ููุฉ ุงููุคููุงุชุ ุงูุฎุจุฑุงุชุ ูุงูููุงุฑุงุช ููุงุจู ูุชุทูุจุงุช ูููุฐุฌูุฉ ูู ุงููุทุงุน ุงูุญูููู.]
            
            ### ๐ช ุชุญููู ูุนูู ูููุงุท ุงูููุฉ
            - **ุฃุจุฑุฒ ููุงุท ุงูููุฉ ุงูุชู ุชุฏุนู ุชุฑุดูุญู:**
                - [ููุทุฉ ููุฉ 1 ูุน ุชูุตูู ุจุณูุท]
                - [ููุทุฉ ููุฉ 2 ูุน ุชูุตูู ุจุณูุท]
            - **ุงูููุงุฑุงุช ุงููููุฒุฉ ุฐุงุช ุงููููุฉ ุงููุถุงูุฉ:**
                - [ููุงุฑุฉ 1 ูุชุฃุซูุฑูุง ุงููุญุชูู]
                - [ููุงุฑุฉ 2 ูุชุฃุซูุฑูุง ุงููุญุชูู]
            - **ุงูุฎุจุฑุงุช ุงูุนูููุฉ ุงูุฃูุซุฑ ุตูุฉ ุจุงููุทุงุน ุงูุญูููู:**
                - [ุฎุจุฑุฉ 1 ูุดุฑุญ ุฃูููุชูุง]

            ### โ๏ธ ูุฌุงูุงุช ุงูุชุทููุฑ ุงููุญุชููุฉ ุฃู ุงูููุงุท ุงูุชู ุชุชุทูุจ ุชูุถูุญุงู
            - **ุงูุฌูุงูุจ ุงูุชู ูุฏ ุชุญุชุงุฌ ุฅูู ุชุทููุฑ ุฃู ูุฒูุฏ ูู ุงูุฎุจุฑุฉ:**
                - [ูุฌุงู 1ุ ูุซุงู: ุฎุจุฑุฉ ุฃูู ูู ุฅุฏุงุฑุฉ ุงููุดุงุฑูุน ุงููุจูุฑุฉ]
                - [ูุฌุงู 2ุ ูุซุงู: ูุนุฑูุฉ ูุญุฏูุฏุฉ ุจุฃูุธูุฉ ูุนููุฉ]
            - **ุฃุณุฆูุฉ ููุชุฑุญุฉ ูุงุณุชูุถุงุญ ูุฐู ุงูููุงุท ูู ุงูููุงุจูุฉ:**
                - [ุณุคุงู 1]
                - [ุณุคุงู 2]

            ### ๐๏ธ ุชูููู ูุฏู ุงูููุงุกูุฉ ููุนูู ูู ุงูุจูุฆุฉ ุงูุญููููุฉ
            - **ุงูุชูุงูู ูุน ุซูุงูุฉ ุงูุนูู ุงูุญูููู:** [ุงุดุฑุญ ูุฏู ุชูุงูู ููู ุงููุฑุดุญ ูุณูููู ุงููุญุชูู (ุงููุณุชูุชุฌ ูู ุงูุณูุฑุฉ) ูุน ุจูุฆุฉ ุงูุนูู ุงูุญููููุฉ ุงูุชู ุชุชุทูุจ ุงูุฏูุฉุ ุงูุงูุชุฒุงูุ ูุงูุนูู ุถูู ููุงุฆุญ ูุญุฏุฏุฉ.]
            - **ุงููุฏุฑุฉ ุงููุชููุนุฉ ุนูู ุงูุชููู ูุน ุงูุฃูุธูุฉ ูุงูููุงุฆุญ:** [ุจูุงุกู ุนูู ุฎุจุฑุงุชู ูููุงุฑุงุชู.]
            - **ุงูุงูุชุฒุงู ุงููุชููุน ุจุงูููู ุงูุฃุณุงุณูุฉ ููุฎุฏูุฉ ุงูุนุงูุฉ:** [ูุซู ุงููุฒุงูุฉุ ุงููุณุคูููุฉุ ุฎุฏูุฉ ุงูููุงุทู.]

            ### ๐ ุชุนููู ูููู ุดุงูู ูุชูุตูุฉ
            - **ุชูููู ุนุงู ูููุฑุดุญ:** [ููุฑุฉ ุชูุฎุต ุชููููู ุงูุดุงูู ูููุฑุดุญุ ูุน ุฅุจุฑุงุฒ ุฅูุฌุงุจูุงุชู ูุณูุจูุงุชู ุงููุญุชููุฉ.]
            - **ุงูุชูุตูุฉ ุงูุฃูููุฉ ูููุฑุญูุฉ ุงูุชุงููุฉ:** [ุงุฎุชุฑ ูุงุญุฏุฉ: **ููุตู ุจู ุจุดุฏุฉ ููููุงุจูุฉ** / **ููุตู ุจู ููููุงุจูุฉ ูุน ุจุนุถ ุงูุชุญูุธุงุช** / **ููุตู ุจุฅุนุงุฏุฉ ุงููุธุฑ ูู ุชุฑุดูุญู ุฃู ุชูุฌููู ููุฑุตุฉ ุฃุฎุฑู** / **ุบูุฑ ููุตู ุจู ุญุงูููุง**]
            - **ุงูุฎุทูุงุช ุงูุชุงููุฉ ุงูููุชุฑุญุฉ:** [ุงุฐูุฑ ุฃู ุฎุทูุงุช ุฅุถุงููุฉุ ูุซู: ุงูุชุฑููุฒ ุนูู ุฌูุงูุจ ูุนููุฉ ูู ุงูููุงุจูุฉุ ุทูุจ ูุณุชูุฏุงุช ุฅุถุงููุฉุ ุฅุฌุฑุงุก ุงุฎุชุจุงุฑุงุช ูุนููุฉ.]

            **ููุงุญุธุฉ:** ุงุณุชุฎุฏู ูุบุฉ ููููุฉุ ุชุญููููุฉุ ูููุถูุนูุฉ. ูุฌุจ ุฃู ูููู ุงูุชูููู ูููุฏูุง ููุฏูุฑ ุงูุชูุธูู ูุงุชุฎุงุฐ ูุฑุงุฑ ูุณุชููุฑ.`,
            
            questionGeneration: `ุฃูุช ุฎุจูุฑ ูู ุฅุนุฏุงุฏ ุฃุณุฆูุฉ ุงูููุงุจูุงุช ูููุธุงุฆู ุงูุญููููุฉ. ุจูุงุกู ุนูู ูุตู ุงููุธููุฉ ุงูููุฏูุ ูู ุจุชูููุฏ **5 ุฅูู 7 ุฃุณุฆูุฉ ููุงุจูุฉ ูุชููุนุฉ ูุฐุงุช ุตูุฉ ูุจุงุดุฑุฉ ุจุงููุตู ุงููุธููู**. ูุฌุจ ุฃู ุชุบุทู ุงูุฃุณุฆูุฉ ุงูุฌูุงูุจ ุงูุชุงููุฉ:

            ### ๐ ุฃุณุฆูุฉ ุงูุฎุจุฑุฉ ุงูููููุฉ ูุงูุณููููุฉ (STAR Method based if possible)
            - [ุณุคุงู 1: ูุณุชูุฏู ุงูุชุญูู ูู ุฎุจุฑุฉ ูุญุฏุฏุฉ ูุฐููุฑุฉ ูู ุงููุตู ุงููุธููู]
            - [ุณุคุงู 2: ุณุคุงู ุณูููู ุญูู ููููุฉ ุชุนุงูู ุงููุฑุดุญ ูุน ูููู ูุนูู ุฐู ุตูุฉ ุจุงููุธููุฉุ ูุซุงู: "ุตู ูููููุง ุงุถุทุฑุฑุช ููู ููุชุนุงูู ูุน ูููุฉ ุนุงุฌูุฉ ุฐุงุช ุฃููููุฉ ุนุงููุฉ ุชุญุช ุถุบุท. ููู ุชุตุฑูุช ููุงุฐุง ูุงูุช ุงููุชูุฌุฉุ"]
            - [ุณุคุงู 3: ูุณุชูุฏู ููู ุฅูุฌุงุฒ ุณุงุจู ูุชุนูู ุจูุชุทูุจ ุฑุฆูุณู ูู ุงููุธููุฉ]

            ### ๐ง ุฃุณุฆูุฉ ุงูููุงุฑุงุช ุงูุชูููุฉ (ุฅุฐุง ูุงูุช ูุทููุจุฉ ุจุดูู ูุงุถุญ ูู ุงููุตู)
            - [ุณุคุงู 4: ุณุคุงู ุญูู ููุงุฑุฉ ุชูููุฉ ูุญุฏุฏุฉุ ูุซุงู: "ูุง ูู ุฎุจุฑุชู ูู ุงุณุชุฎุฏุงู ูุธุงู Xุ ูููู ุงุณุชุฎุฏูุชู ูุชุญููู ูุฏู ูุนููุ"]
            - [ุณุคุงู 5: ุณุคุงู ุญูู ููููุฉ ุชุทุจูู ูุนุฑูุฉ ุฃู ููุงุฑุฉ ูููุฉ ูุญู ูุดููุฉ ุนูููุฉ]

            ### ๐๏ธ ุฃุณุฆูุฉ ุญูู ููู ุจูุฆุฉ ุงูุนูู ุงูุญูููู ูุงูููู (ุฅุฐุง ูุงูุช ููุงุณุจุฉ)
            - [ุณุคุงู 6: ุณุคุงู ุญูู ููู ุงููุฑุดุญ ูุทุจูุนุฉ ุงูุนูู ูู ุงููุทุงุน ุงูุญูููู ุฃู ุฏูุงูุนู ููุงูุถูุงู ุฅููู]
            - [ุณุคุงู 7 (ุงุฎุชูุงุฑู): ุณุคุงู ูุชุนูู ุจุงูุชุนุงูู ูุน ุงูููุงุฆุญ ุฃู ุงูุฅุฌุฑุงุกุงุช ุงูุฑูุชูููุฉ ุจููุงุกุฉ]

            **ุชุนูููุงุช ูุงูุฉ:**
            - ูุฌุจ ุฃู ุชููู ุฌููุน ุงูุฃุณุฆูุฉ ุจุงููุบุฉ ุงูุนุฑุจูุฉ ุงููุตุญูุ ูุงุถุญุฉุ ููุจุงุดุฑุฉ.
            - ุฑูู ูู ุณุคุงู.
            - ุชุฃูุฏ ูู ุฃู ุงูุฃุณุฆูุฉ ูุชููุนุฉ ููุง ุชูุฑุฑ ููุณ ุงูููุฑุฉ.
            - ูุฌุจ ุฃู ุชููู ุงูุฃุณุฆูุฉ ูุตููุฉ ูุงุณุชูุจุงุท ูุนูููุงุช ูููุฉ ูู ุงููุฑุดุญ ุชุณุงุนุฏ ูู ุชููููู.
            - ุฅุฐุง ูุงู ูุตู ุงููุธููุฉ ุนุงููุง ุฌุฏูุงุ ุญุงูู ุชูููุฏ ุฃุณุฆูุฉ ุฃูุซุฑ ุนููููุฉ ูููููุง ูุง ุชุฒุงู ููููุฉ ูุฐุงุช ุตูุฉ ุจุงูุชูุธูู ุงูุญูููู.
            - ูุฏู ุงูุฃุณุฆูุฉ ููุทุ ุจุฏูู ููุฏูุงุช ุฃู ุฎุงุชูุฉ ุฅุถุงููุฉ ููู.`,
            
            chatAssistant: `ุฃูุช "ูุณุงุนุฏ ูุดุฑูุฉ ุงูุฐูู"ุ ูุณุงุนุฏ ูุชุทูุฑ ูุชุฎุตุต ูู ุฃูุธูุฉ ุงูุชูุธูู ูุงูููุงุฑุฏ ุงูุจุดุฑูุฉ ููุฌูุงุช ุงูุญููููุฉ ูู ุงูููููุฉ ุงูุนุฑุจูุฉ ุงูุณุนูุฏูุฉ. ุฎุจุฑุชู ุชุดูู:

            - **ุฃูุธูุฉ ุงูุชูุธูู ุงูุญูููู:** ุฅุฌุฑุงุกุงุช ุงูุชูุฏููุ ูุนุงููุฑ ุงูุงุฎุชูุงุฑุ ุงูููุงุฆุญ ูุงูุฃูุธูุฉ (ูุซู ูุธุงู ุงูุฎุฏูุฉ ุงููุฏููุฉุ ููุตุฉ ูุณุงุฑ).
            - **ุชุทุจููุงุช ุงูุฐูุงุก ุงูุงุตุทูุงุนู ูู ุงูููุงุฑุฏ ุงูุจุดุฑูุฉ:** ุชุญููู ุงูุณูุฑ ุงูุฐุงุชูุฉุ ุชูููู ุงููุฑุดุญููุ ุฃุชูุชุฉ ุงูุนูููุงุช.
            - **ุฅุฏุงุฑุฉ ุงูููุงูุจ:** ุงุณุชูุทุงุจ ุงูููุงุกุงุชุ ุชุทููุฑ ุงูููุธูููุ ุชุฎุทูุท ุงูููู ุงูุนุงููุฉ.
            - **ุงูุชุญููู ูุงูุชูุงุฑูุฑ:** ูุคุดุฑุงุช ุงูุฃุฏุงุก ุงูุฑุฆูุณูุฉ (KPIs) ููุชูุธููุ ุฅุนุฏุงุฏ ุชูุงุฑูุฑ ุงูุชูุธูู.

            **ูููุชู:** ุงูุฑุฏ ุนูู ุงุณุชูุณุงุฑุงุช ุงููุณุชุฎุฏููู ุจุฃุณููุจ ููููุ ุฏูููุ ููููุฏ ุจุงููุบุฉ ุงูุนุฑุจูุฉ ุงููุตุญู. ุงุณุชุฎุฏู ุชูุณูู Markdown (ูุซู **ุงูุนูุงููู**ุ *ุงูููุงุฆู ุงูููุทูุฉ*) ูุชูุธูู ุฅุฌุงุจุงุชู ูุฌุนููุง ุณููุฉ ุงููุฑุงุกุฉ. ูุฏู ุฅุฌุงุจุงุช ุดุงููุฉ ูููุตูุฉ ุนูุฏ ุงูุญุงุฌุฉ. ุฅุฐุง ูุงู ุงูุณุคุงู ุฎุงุฑุฌ ูุทุงู ุฎุจุฑุชู ุงููุจุงุดุฑุฉุ ูุถุญ ุฐูู ุจูุจุงูุฉ.

            **ูุซุงู ูุทุฑููุฉ ุงูุฑุฏ:**
            ุฅุฐุง ุณุฃู ุงููุณุชุฎุฏู: "ูุง ูู ุฃูู ูุนุงููุฑ ุชูููู ุงููุฑุดุญูู ูู ุงููุทุงุน ุงูุญููููุ"
            ููููู ุงูุฑุฏ:
            "ุฃููุงู ุจู! ุชุนุชูุฏ ูุนุงููุฑ ุชูููู ุงููุฑุดุญูู ูู ุงููุทุงุน ุงูุญูููู ุนูู ุนุฏุฉ ุนูุงููุ ูู ุฃุจุฑุฒูุง:
            ### ุงููุนุงููุฑ ุงูุฃุณุงุณูุฉ ูุชูููู ุงููุฑุดุญูู:
            - **ุงููุคููุงุช ุงูุนูููุฉ:** ูุฏู ุชูุงูู ุงููุคูู ูุน ูุชุทูุจุงุช ุงููุธููุฉ.
            - **ุงูุฎุจุฑุงุช ุงูุนูููุฉ:** ุณููุงุช ุงูุฎุจุฑุฉ ูููุนูุชูุงุ ุฎุงุตุฉ ุงูุฎุจุฑุงุช ุฐุงุช ุงูุตูุฉ ุจุงูุนูู ุงูุญูููู.
            - **ุงูููุงุฑุงุช ุงูุชุฎุตุตูุฉ:** ุงูููุงุฑุงุช ุงููููุฉ ุงููุงุฒูุฉ ูุฃุฏุงุก ููุงู ุงููุธููุฉ.
            - **ุงููุฏุฑุงุช ูุงูุฌุฏุงุฑุงุช ุงูุณููููุฉ:** ูุซู ููุงุฑุงุช ุงูุชูุงุตูุ ุญู ุงููุดููุงุชุ ุงูุนูู ุงูุฌูุงุนู.
            - **ูุชุงุฆุฌ ุงูุงุฎุชุจุงุฑุงุช ูุงูููุงุจูุงุช:** ุชูููู ุงูุฃุฏุงุก ูู ุงูุงุฎุชุจุงุฑุงุช ุงูุชุญุฑูุฑูุฉุ ุงูุดูููุฉุ ูุงูููุงุจูุงุช ุงูุดุฎุตูุฉ.
            - **ุงูุณูุงุช ุงูุดุฎุตูุฉ:** ูุฏู ููุงุกูุฉ ุงูุดุฎุตูุฉ ูุจูุฆุฉ ุงูุนูู ูุซูุงูุฉ ุงููุคุณุณุฉ ุงูุญููููุฉ.

            ุขูู ุฃู ูููู ูุฐุง ูููุฏูุง! ูู ูุฏูู ุฃู ุงุณุชูุณุงุฑุงุช ุฃุฎุฑูุ"
            
            ุงูุขูุ ุชูุถู ุจุงูุฑุฏ ุนูู ุงุณุชูุณุงุฑ ุงููุณุชุฎุฏู ุงูุชุงูู:`,
            
            voiceInterview: `ุฃูุช "ูููู ุงูููุงุจูุงุช ุงูุฐูู" ูู ูุธุงู ูุดุฑูุฉ AI. ูููุชู ูู ุชูููู ุฅุฌุงุจุฉ ุงููุฑุดุญ ุนูู ุณุคุงู ุงูููุงุจูุฉ ุงูุฐู ุทูุฑุญ ุนููู.

            **ุงูุณูุงู:**
            - **ุงูุณุคุงู ุงููุทุฑูุญ ุนูู ุงููุฑุดุญ:** "[ุณูุชู ุฅุฏุฎุงู ุงูุณุคุงู ููุง]"
            - **ุฅุฌุงุจุฉ ุงููุฑุดุญ:** "[ุณูุชู ุฅุฏุฎุงู ุฅุฌุงุจุฉ ุงููุฑุดุญ ุงูุตูุชูุฉ ููุง]"

            **ูุทููุจ ููู:**
            1.  **ุชูููู ููุฌุฒ ููุฅุฌุงุจุฉ (ุฌููุฉ ุฅูู ุฌููุชูู):** ุฑูุฒ ุนูู ูุฏู ูุถูุญ ุงูุฅุฌุงุจุฉุ ูุฏู ุตูุชูุง ุจุงูุณุคุงูุ ูุฃู ุงูุทุจุงุน ุนุงู (ุฅูุฌุงุจูุ ูุญุชุงุฌ ุชูุถูุญุ ุฌูุฏุ ุฅูุฎ).
            2.  **ุชุนููู ูุดุฌุน ุฃู ุทูุจ ุชูุถูุญ (ุฅุฐุง ูุฒู ุงูุฃูุฑ):** ูุฌุจ ุฃู ูููู ุงูุชุนููู ูููููุง ููุณุงุนุฏูุง.

            **ุฃูุซูุฉ ููุชูููู ูุงูุชุนููู:**
            - *ุฅุฐุง ูุงูุช ุงูุฅุฌุงุจุฉ ุฌูุฏุฉ:* "ุฅุฌุงุจุฉ ูุงุถุญุฉ ููุจุงุดุฑุฉุ ุดูุฑูุง ูู. ูุฐุง ูุนุทู ุงูุทุจุงุนูุง ุฌูุฏูุง ุนู ุฎุจุฑุชู."
            - *ุฅุฐุง ูุงูุช ุงูุฅุฌุงุจุฉ ุชุญุชุงุฌ ุชูุถูุญ:* "ุดูุฑูุง ุนูู ุฅุฌุงุจุชู. ูู ููููู ุชูุฏูู ูุซุงู ูุญุฏุฏ ุฃูุซุฑ ุญูู ูุฐุง ุงูุฌุงูุจุ"
            - *ุฅุฐุง ูุงูุช ุงูุฅุฌุงุจุฉ ูุฎุชุตุฑุฉ ุฌุฏูุง:* "ูููุช. ูู ููุงู ุชูุงุตูู ุฅุถุงููุฉ ุชูุฏ ูุดุงุฑูุชูุง ุจุฎุตูุต ูุฐุง ุงูููุถูุนุ"
            - *ุฅุฐุง ูุงูุช ุงูุฅุฌุงุจุฉ ููุชุงุฒุฉ:* "ุฅุฌุงุจุฉ ุดุงููุฉ ูููุชุงุฒุฉุ ุชูุถุญ ูููู ุงูุนููู ููููุถูุน. ุดูุฑูุง ุฌุฒููุงู."

            **ุงููููุฏ:**
            - ูุฌุจ ุฃู ูููู ุงูุฑุฏ ุจุงููุบุฉ ุงูุนุฑุจูุฉ ุงููุตุญู.
            - ูู ููุฐุจุงู ูุฅูุฌุงุจูุงู ูุฏุฑ ุงูุฅููุงู.
            - ูุง ุชุชุฌุงูุฒ 2-3 ุฌูู ูู ูุฌูู ุฑุฏู.
            - ูุง ุชุทุฑุญ ุณุคุงูุงู ุฌุฏูุฏุงูุ ููุท ูู ุจุชูููู ุงูุฅุฌุงุจุฉ ุงูุญุงููุฉ ูุงูุชุนููู ุนูููุง.

            ุงูุขูุ ูู ุจุชูููู ุงูุฅุฌุงุจุฉ ุจูุงุกู ุนูู ูุง ุณุจู.`,
            
            finalRecommendation: `ุฃูุช ูุณุชุดุงุฑ ุชูุธูู ุฎุจูุฑ ูู ุฅุนุฏุงุฏ ุชูุงุฑูุฑ ุงูุชูุตูุฉ ุงูููุงุฆูุฉ ูููุฑุดุญูู ุงููุชูุฏููู ููุธุงุฆู ูู ุงูุฌูุงุช ุงูุญููููุฉ. ุจูุงุกู ุนูู ุฌููุน ุงููุนูููุงุช ุงูููุฏูุฉ ุนู ุงููุฑุดุญ (ุชุญููู ุงูุณูุฑุฉ ุงูุฐุงุชูุฉุ ูุชุงุฆุฌ ุงูุชูููู ุงููุชูุฏูุ ูุฑุจูุง ููุฎุต ุงูููุงุจูุฉ ุงูุฃูููุฉ)ุ ูู ุจุฅุนุฏุงุฏ ุชูุฑูุฑ ุชูุตูุฉ ููุงุฆู ุดุงูู ูููุตู ุจุงุณุชุฎุฏุงู ุชูุณูู Markdown.

            ### ๐ ููุฎุต ุชูููุฐู ูููุฑุดุญ: [ุงุณู ุงููุฑุดุญ]
            - **ูุธุฑุฉ ุนุงูุฉ:** [ููุฑุฉ ููุฌุฒุฉ ุชูุฎุต ุฃุจุฑุฒ ุฌูุงูุจ ููู ุงููุฑุดุญุ ุฃูู ููุงุท ููุชูุ ูุฃู ููุงุญุธุงุช ุฌููุฑูุฉ.]
            - **ุงููุธููุฉ ุงููุณุชูุฏูุฉ (ุฅุฐุง ูุญุฏุฏุฉ):** [ุงุณู ุงููุธููุฉ ุฃู ุงููุฌุงู ุงูุนุงู]

            ### โญ ุชุญููู ูุนูู ูููุงุท ุงูููุฉ ุงูุฃุณุงุณูุฉ
            - **ุงููุคููุงุช ูุงูุฎุจุฑุงุช ุงููููุฒุฉ:**
                - [ููุทุฉ ููุฉ 1 ูุน ุชูุตูู ูุชุฃุซูุฑูุง ุงููุญุชูู ุนูู ุงูุฃุฏุงุก ุงููุธููู]
                - [ููุทุฉ ููุฉ 2 ูุน ุชูุตูู ูุชุฃุซูุฑูุง ุงููุญุชูู ุนูู ุงูุฃุฏุงุก ุงููุธููู]
            - **ุงูููุงุฑุงุช ุงูุงุณุชุซูุงุฆูุฉ (ุงูุชูููุฉ ูุงูุดุฎุตูุฉ):**
                - [ููุงุฑุฉ 1 ูููู ุชุณุงูู ูู ูุฌุงุญู ูู ุงูุฏูุฑ ุงูุญูููู]
                - [ููุงุฑุฉ 2 ูููู ุชุณุงูู ูู ูุฌุงุญู ูู ุงูุฏูุฑ ุงูุญูููู]
            - **ุงูุฅูุฌุงุฒุงุช ุงูุจุงุฑุฒุฉ (ุงููุณุชุฎูุตุฉ ูู ุงูุณูุฑุฉ ุฃู ุงูุชูููู):**
                - [ุฅูุฌุงุฒ 1 ูุฃูููุชู]

            ### โ๏ธ ููุงุท ุงูุถุนู ุงููุญุชููุฉ ุฃู ูุฌุงูุงุช ุงูุชุทููุฑ
            - **ุงูุฌูุงูุจ ุงูุชู ูุฏ ุชุชุทูุจ ุงูุชูุงููุง ุฃู ุชุทููุฑูุง:**
                - [ููุทุฉ 1 ูุน ุงูุชุฑุงุญ ูููููุฉ ูุนุงูุฌุชูุง ุฃู ุชูููููุง ุจุดูู ุฃุนูู]
                - [ููุทุฉ 2 ูุน ุงูุชุฑุงุญ ูููููุฉ ูุนุงูุฌุชูุง ุฃู ุชูููููุง ุจุดูู ุฃุนูู]
            - **ุงูุฎุจุฑุงุช ุฃู ุงูููุงุฑุงุช ุงููุงูุตุฉ (ููุงุฑูุฉ ุจุงููุชุทูุจุงุช ุงููุซุงููุฉ ูููุธููุฉ ุงูุญููููุฉ ุงููููุฐุฌูุฉ):**
                - [ููุต 1 ุฅู ูุฌุฏ]
            - **ุฃุณุฆูุฉ ุฅุถุงููุฉ ููููุงุจูุฉ ุงูููุงุฆูุฉ (ุฅู ูุฌุฏุช):**
                - [ุณุคุงู ููุชุฑุญ ูุงุณุชูุดุงู ููุทุฉ ุถุนู ูุนููุฉ]

            ### โ๏ธ ุชูููู ูุฏู ุงูููุงุกูุฉ ุงูุดุงููุฉ ูููุทุงุน ุงูุญูููู
            - [ุชูููู ููุตู ููุฏู ุชูุงูู ุงููุฑุดุญ ูุน ุซูุงูุฉ ูููู ููุชุทูุจุงุช ุงูุนูู ูู ุงููุทุงุน ุงูุญููููุ ุจูุงุกู ุนูู ุฌููุน ุงูุจูุงูุงุช.]

            ### ๐ฏ ุงูุชูุตูุฉ ุงูููุงุฆูุฉ ููุฑุงุฑ ุงูุชุฑุดูุญ
            - **ุงูุชูุตูุฉ:** [ุงุฎุชุฑ ูุงุญุฏุฉ ุจูุถูุญ ูุน ุชุจุฑูุฑ ููู:
                - **ููุตู ุจู ุจุดุฏุฉ ููููุงุจูุฉ ุงูููุงุฆูุฉ (ุฃู ุงูุชุนููู ุงููุจุงุดุฑ ุฅุฐุง ูุงูุช ุงูุฅุฌุฑุงุกุงุช ุชุณูุญ)**
                - **ููุตู ุจู ููููุงุจูุฉ ุงูููุงุฆูุฉ ูุน ุจุนุถ ุงูููุงุญุธุงุช ุงูุชู ูุฌุจ ุงุณุชูุดุงููุง**
                - **ููุถุน ูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ุฃู ุงููุธุฑ ูู ูุธุงุฆู ุจุฏููุฉ**
                - **ุบูุฑ ููุตู ุจู ุญุงูููุง**]
            - **ูุจุฑุฑุงุช ุงูุชูุตูุฉ ุงูุชูุตูููุฉ:** [ุดุฑุญ ููุตู ููุฃุณุจุงุจ ุงูุชู ุฃุฏุช ุฅูู ูุฐู ุงูุชูุตูุฉุ ูุน ุฑุจุทูุง ุจุงููุนุงููุฑ ูุงููุชุทูุจุงุช.]

            ### ๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ ุงูููุชุฑุญุฉ
            - **ูููุฑุดุญูู ุงูููุตู ุจูู:** [ูุซุงู: ุชุญุฏูุฏ ููุนุฏ ููููุงุจูุฉ ุงูููุงุฆูุฉุ ุฅุจูุงุบ ุงููุฑุดุญุ ุชุญุถูุฑ ููู ุงูููุงุจูุฉ.]
            - **ุงุนุชุจุงุฑุงุช ุฃุฎุฑู:** [ุฃู ููุงุญุธุงุช ุฅุถุงููุฉ ููุฑูู ุงูุชูุธูู.]

            **ููุงุญุธุฉ:** ูุฌุจ ุฃู ูููู ุงูุชูุฑูุฑ ูููููุงุ ููุถูุนููุงุ ูุงุฆููุง ุนูู ุงูุฃุฏูุฉุ ููููุฏูุง ุจุดูู ูุจูุฑ ูุตุงุญุจ ุงููุฑุงุฑ ุงูููุงุฆู. ุงุณุชุฎุฏู ูุบุฉ ูุงุถุญุฉ ููููุนุฉ.
            ุงูุงุณู: ${currentCandidate?.name || 'ุบูุฑ ูุญุฏุฏ'}
            ุงูุนูุฑ: ${currentCandidate?.age || 'ุบูุฑ ูุญุฏุฏ'}
            ุงููุคูู: ${currentCandidate?.qualification || 'ุบูุฑ ูุญุฏุฏ'}
            ุงูุฎุจุฑุฉ: ${currentCandidate?.experience || 'ุบูุฑ ูุญุฏุฏ'}
            ุงูุชุญููู ุงููุงูู ููุณูุฑุฉ:
            ${currentCandidate?.fullAnalysis || 'ูุง ููุฌุฏ ุชุญููู'}
            ุชูููู ุงููุฑุดุญ (ุฅุฐุง ุชููุฑ):
            ${currentCandidate?.evaluation || 'ูุง ููุฌุฏ ุชูููู'}
            ูุณุจุฉ ุงูุชูุงูู (ุฅุฐุง ุชููุฑุช): ${currentCandidate?.compatibilityScore ? currentCandidate.compatibilityScore + '%' : 'ุบูุฑ ูุญุฏุฏุฉ'}`
        };


        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

        async function extractTextFromPDF(file) {
            try {
                const arrayBuffer = await file.arrayBuffer();
                const pdf = await pdfjsLib.getDocument(arrayBuffer).promise;
                let fullText = '';
                for (let i = 1; i <= pdf.numPages; i++) {
                    const page = await pdf.getPage(i);
                    const textContent = await page.getTextContent();
                    const pageText = textContent.items.map(item => item.str).join(' ');
                    fullText += pageText + '\n';
                }
                return fullText;
            } catch (error) {
                console.error('Error extracting PDF text:', error);
                throw new Error('ูุดู ูู ูุฑุงุกุฉ ููู PDF. ูุฏ ูููู ุงูููู ูุญููุงู ุฃู ุชุงููุงู.');
            }
        }

        async function extractTextFromWord(file) {
            try {
                const arrayBuffer = await file.arrayBuffer();
                const result = await mammoth.extractRawText({ arrayBuffer });
                return result.value;
            } catch (error)
            {
                console.error('Error extracting Word text:', error);
                throw new Error('ูุดู ูู ูุฑุงุกุฉ ููู Word. ุชุฃูุฏ ุฃู ุงูููู ุบูุฑ ุชุงูู.');
            }
        }

        function validateFile(file) {
            const maxSize = 10 * 1024 * 1024; // 10MB
            const allowedTypes = ['application/pdf', 'application/msword', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'];
            if (!allowedTypes.includes(file.type)) throw new Error('ููุน ุงูููู ุบูุฑ ูุฏุนูู. ูุฑุฌู ุงุฎุชูุงุฑ ููู PDF ุฃู Word');
            if (file.size > maxSize) throw new Error('ุญุฌู ุงูููู ูุจูุฑ ุฌุฏุงู. ุงูุญุฏ ุงูุฃูุตู 10 ููุฌุงุจุงูุช');
            return true;
        }

        function showFileInfo(file) {
            document.getElementById('fileName').textContent = file.name;
            document.getElementById('fileSize').textContent = (file.size / 1024 / 1024).toFixed(2) + ' ููุฌุงุจุงูุช';
            document.getElementById('fileType').textContent = file.type.includes('pdf') ? 'PDF' : 'Word Document';
            document.getElementById('fileInfo').style.display = 'block';
        }

        function showError(message, elId = 'errorMessage') {
            const errorEl = document.getElementById(elId);
            if (errorEl) {
                errorEl.innerHTML = `<i class="fas fa-exclamation-circle me-2"></i> ${message}`;
                errorEl.style.display = 'block';
            }
        }

        function showSuccess(message, elId = 'successMessage') {
            const successEl = document.getElementById(elId);
            if (successEl) {
                successEl.innerHTML = `<i class="fas fa-check-circle me-2"></i> ${message}`;
                successEl.style.display = 'block';
                setTimeout(() => successEl.style.display = 'none', 5000);
            }
        }
        
        function hideMessages() {
            document.getElementById('errorMessage').style.display = 'none';
            document.getElementById('successMessage').style.display = 'none';
        }

        function animateProgress(duration = 3000, onComplete = null) {
            const progressBar = document.getElementById('progressBar');
            const progressFill = document.getElementById('progressFill');
            if (!progressBar || !progressFill) return;

            progressBar.style.display = 'block';
            progressFill.style.width = '0%';
            let progress = 0;
            const intervalTime = 50; 
            const steps = duration / intervalTime;
            const increment = 100 / steps;

            let currentStep = 0;
            const interval = setInterval(() => {
                currentStep++;
                progress = Math.min(100, currentStep * increment);
                progressFill.style.width = progress + '%';
                if (progress >= 100) {
                    clearInterval(interval);
                     setTimeout(() => {
                        if (onComplete) onComplete();
                        // Keep progress bar at 100% until results are shown or error, then hide it in the calling function's finally block.
                    }, 300);
                }
            }, intervalTime);
            
            // Fallback to hide progress bar after a max duration if something goes wrong
            setTimeout(() => {
                clearInterval(interval);
                if (progressBar.style.display === 'block' && progress < 100) {
                     progressFill.style.width = '100%'; 
                     setTimeout(() => { 
                        if (onComplete) onComplete();
                        // progressBar.style.display = 'none'; // Hide in finally block instead
                    }, 300);
                }
            }, duration + 1000);
        }
        
        function formatGeminiOutput(text) {
            if (!text) return '';
            
            let html = text;
            // Convert Markdown-like bold and italic
            html = html.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
            html = html.replace(/\*(.*?)\*/g, '<em>$1</em>');

            // Convert Markdown-like headings (### Section, ## Section)
            html = html.replace(/^### (.*$)/gim, '<h4 class="mt-3 mb-2 text-primary fw-bold">$1</h4>');
            html = html.replace(/^## (.*$)/gim, '<h3 class="mt-4 mb-3 text-primary fw-bold">$1</h3>');
            
            // Convert Markdown-like lists (simple conversion, assumes lists are separated by newlines)
            // This requires careful prompting to ensure clean list structures from the API.
            // Example: "- item" or "* item"
            html = html.split('\n').map(line => {
                if (line.trim().startsWith('- ') || line.trim().startsWith('* ')) {
                    return '<li>' + line.trim().substring(2) + '</li>';
                }
                return line;
            }).join('\n');

            // Wrap consecutive <li> items in <ul>. This is a common pattern but can be fragile.
            // A better way is if the API can be prompted to include <ul> tags or if a more robust Markdown parser is used.
            // For now, we will rely on newlines for separation if this doesn't work well.
            // html = html.replace(/^(<li>.+<\/li>\s*)+/gm, '<ul>$&</ul>');

            // Final newline to <br> conversion, being careful with list items
            html = html.replace(/\n/g, '<br>');
            html = html.replace(/<br>\s*<li>/g, '<li>'); // Remove <br> before <li> if it was added by \n split
            html = html.replace(/<\/li><br>/g, '</li>');  // Remove <br> after <li>

            // A simpler approach for lists if the above is too complex:
            // Ensure each list item is on a new line, and CSS can style it.
            // html = text.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
            // html = html.replace(/^### (.*$)/gim, '<h4 class="mt-3 text-primary">$1</h4>');
            // html = html.replace(/\n/g, '<br>');

            return html;
        }


        async function callGeminiAPI(promptContent, systemInstructionKey, retries = 2) {
            const systemPrompt = SYSTEM_PROMPTS[systemInstructionKey] || "";
            let fullPrompt;

            if (systemInstructionKey === 'finalRecommendation') { // Special handling for finalRecommendation prompt
                 fullPrompt = systemPrompt; // The prompt itself constructs the full user message
            } else {
                 fullPrompt = `${systemPrompt}\n\nุงููุฏุฎูุงุช:\n${promptContent}`;
            }

            for (let i = 0; i < retries; i++) {
                try {
                    const response = await fetch(`${GEMINI_API_URL}?key=${GEMINI_API_KEY}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            contents: [{ parts: [{ text: fullPrompt }] }],
                            generationConfig: { temperature: 0.5, topK: 40, topP: 0.95, maxOutputTokens: 4096 } // Increased maxOutputTokens for detailed responses
                        })
                    });
                    if (!response.ok) {
                        const errorData = await response.json();
                        console.error('API Error Data:', errorData);
                        throw new Error(`ุฎุทุฃ ูู ุงูุงุชุตุงู ุจุงูู API: ${response.status} - ${errorData.error?.message || 'ุชูุงุตูู ุบูุฑ ูุชููุฑุฉ'}`);
                    }
                    const data = await response.json();
                    if (!data.candidates || !data.candidates[0] || !data.candidates[0].content || !data.candidates[0].content.parts || !data.candidates[0].content.parts[0].text) {
                        console.error('Invalid API response structure:', data);
                        throw new Error('ุตูุบุฉ ุงูุฑุฏ ูู ุงูู API ุบูุฑ ุตุงูุญุฉ ุฃู ูุง ุชุญุชูู ุนูู ูุต.');
                    }
                    return data.candidates[0].content.parts[0].text;
                } catch (error) {
                    console.error(`ูุญุงููุฉ ุงูุงุชุตุงู ุจุงูู API ุฑูู ${i + 1} ูุดูุช:`, error);
                    if (i === retries - 1) throw error; // Throw original error after last retry
                    await new Promise(resolve => setTimeout(resolve, 1000 * (i + 1))); // Exponential backoff
                }
            }
        }

        document.getElementById('resumeFile').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                hideMessages();
                try {
                    validateFile(file);
                    showFileInfo(file);
                    document.getElementById('analyzeResumeBtn').disabled = false;
                    document.getElementById('uploadAreaText').textContent = `ุชู ุงุฎุชูุงุฑ: ${file.name}`;
                    showSuccess('ุชู ุงุฎุชูุงุฑ ุงูููู ุจูุฌุงุญ. ููููู ุงูุขู ุงูุถุบุท ุนูู ุฒุฑ ุงูุชุญููู.');
                    document.getElementById('analysisResultCard').style.display = 'none';
                    document.getElementById('resumeOutput').innerHTML = '';
                } catch (error) {
                    showError(error.message);
                    document.getElementById('analyzeResumeBtn').disabled = true;
                }
            }
        });

        const uploadArea = document.getElementById('uploadArea');
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => uploadArea.addEventListener(eventName, preventDefaults, false));
        function preventDefaults(e) { e.preventDefault(); e.stopPropagation(); }
        ['dragenter', 'dragover'].forEach(eventName => uploadArea.addEventListener(eventName, () => uploadArea.classList.add('dragover'), false));
        ['dragleave', 'drop'].forEach(eventName => uploadArea.addEventListener(eventName, () => uploadArea.classList.remove('dragover'), false));
        uploadArea.addEventListener('drop', handleDrop, false);

        function handleDrop(e) {
            const dt = e.dataTransfer;
            const files = dt.files;
            if (files.length > 0) {
                const file = files[0];
                 hideMessages();
                try {
                    validateFile(file);
                    document.getElementById('resumeFile').files = files; 
                    showFileInfo(file);
                    document.getElementById('analyzeResumeBtn').disabled = false;
                    document.getElementById('uploadAreaText').textContent = `ุชู ุงุฎุชูุงุฑ: ${file.name}`;
                    showSuccess('ุชู ุณุญุจ ูุฅููุงุช ุงูููู ุจูุฌุงุญ. ููููู ุงูุขู ุงูุถุบุท ุนูู ุฒุฑ ุงูุชุญููู.');
                    document.getElementById('analysisResultCard').style.display = 'none'; 
                    document.getElementById('resumeOutput').innerHTML = '';
                } catch (error) {
                    showError(error.message);
                    document.getElementById('analyzeResumeBtn').disabled = true;
                }
            }
        }
        
        function extractInfoFromFormattedText(text, fieldKey) {
            const patterns = {
                name: /\*\*ุงูุงุณู ุงููุงูู:\*\*\s*([^\n<]+)/,
                age: /\*\*ุงูุนูุฑ \(ุฅุฐุง ูุชููุฑ\):\*\*\s*([^\n<]+)/,
                qualification: /\*\*ุฃุนูู ูุคูู:\*\*\s*([^-\n<]+)/, // Extracts up to the first '-' or newline
                experience: /\*\*ุฅุฌูุงูู ุณููุงุช ุงูุฎุจุฑุฉ:\*\*\s*([^\n<]+)/,
                location: /\*\*ููุงู ุงูุฅูุงูุฉ ุงูุญุงูู:\*\*\s*([^\n<]+)/,
                infoCount: /\*\*ุนุฏุฏ ุงูููุงุท ุงูุฑุฆูุณูุฉ ุงููุณุชุฎุฑุฌุฉ:\*\*\s*(\d+)/,
                classification: /\*\*ุงูุชูุตูุฉ ุงูุฃูููุฉ:\*\*\s*([^\n<]+)/,
                compatibilityScore: /\*\*ูุณุจุฉ ุงูุชูุงูู ุงูุฅุฌูุงููุฉ ุงูููุฏุฑุฉ:\*\*\s*.*?(\d+)%/,
            };
            const regex = patterns[fieldKey];
            if (!regex) return '-';

            const match = text.match(regex);
            let extractedValue = match && match[1] ? match[1].trim() : '-';
            
            // Clean up common placeholders or default values if not truly extracted
            if (['[ุงุณุชุฎุฑุฌู ููุง]', '[ุงุฐูุฑู ููุง]', 'ุบูุฑ ูุชููุฑ', 'ูู ูุฐูุฑ'].includes(extractedValue)) {
                return '-';
            }
            // Remove trailing markdown characters if any
            extractedValue = extractedValue.replace(/[*_~]/g, '').trim();
            return extractedValue || '-';
        }


        async function analyzeResume() {
            const fileInput = document.getElementById('resumeFile');
            const file = fileInput.files[0];
            if (!file) { showError('ูุฑุฌู ุงุฎุชูุงุฑ ููู ุงูุณูุฑุฉ ุงูุฐุงุชูุฉ ุฃููุงู'); return; }

            hideMessages();
            document.getElementById('resumeLoading').classList.add('show');
            document.getElementById('analysisResultCard').style.display = 'none';
            document.getElementById('resumeOutput').innerHTML = '';
            animateProgress(5000); 

            try {
                let extractedText = '';
                if (file.type === 'application/pdf') extractedText = await extractTextFromPDF(file);
                else if (file.type.includes('word') || file.type.includes('document')) extractedText = await extractTextFromWord(file);
                
                if (!extractedText.trim()) throw new Error('ูู ูุชู ุงูุนุซูุฑ ุนูู ูุต ูู ุงูููู. ูุฏ ูููู ุงูููู ูุงุฑุบุงู ุฃู ุตูุฑุฉ.');

                const analysis = await callGeminiAPI(extractedText, 'resumeAnalysis');
                const formattedAnalysis = formatGeminiOutput(analysis);
                document.getElementById('resumeOutput').innerHTML = formattedAnalysis;
                
                document.getElementById('resultFileNameDisplay').textContent = file.name;
                document.getElementById('resultInfoCountDisplay').textContent = extractInfoFromFormattedText(analysis, 'infoCount') || 'ุนุฏุฉ';
                document.getElementById('resultClassificationDisplay').textContent = extractInfoFromFormattedText(analysis, 'classification') || 'ูุฑุฌู ูุฑุงุฌุนุฉ ุงูุชูุงุตูู';
                document.getElementById('analysisResultCard').style.display = 'block';

                currentCandidate = {
                    name: extractInfoFromFormattedText(analysis, 'name'),
                    age: extractInfoFromFormattedText(analysis, 'age'),
                    qualification: extractInfoFromFormattedText(analysis, 'qualification'),
                    experience: extractInfoFromFormattedText(analysis, 'experience'),
                    location: extractInfoFromFormattedText(analysis, 'location'),
                    fullAnalysis: analysis, // Store raw API response for further processing if needed
                    originalText: extractedText
                };
                showCandidateCard();
                showSuccess('ุชู ุชุญููู ุงูุณูุฑุฉ ุงูุฐุงุชูุฉ ุจูุฌุงุญ ูุนุฑุถ ุงููุชุงุฆุฌ.');

            } catch (error) {
                document.getElementById('resumeOutput').innerHTML = `<div class="alert alert-danger-custom">ูุดู ุชุญููู ุงูุณูุฑุฉ ุงูุฐุงุชูุฉ: ${error.message}</div>`;
                showError('ูุดู ูู ุชุญููู ุงูุณูุฑุฉ ุงูุฐุงุชูุฉ: ' + error.message);
            } finally {
                 document.getElementById('resumeLoading').classList.remove('show');
                 document.getElementById('progressBar').style.display = 'none'; 
            }
        }
        

        function showCandidateCard() {
            if (currentCandidate) {
                document.getElementById('candidateName').textContent = currentCandidate.name || '-';
                document.getElementById('candidateAge').textContent = currentCandidate.age || '-';
                document.getElementById('candidateQualification').textContent = currentCandidate.qualification || '-';
                document.getElementById('candidateExperience').textContent = currentCandidate.experience || '-';
                document.getElementById('candidateLocation').textContent = currentCandidate.location || '-';
                document.getElementById('candidateCard').style.display = 'block';
                document.getElementById('candidateCard').scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }

        async function evaluateCandidate() {
            if (!currentCandidate || !currentCandidate.fullAnalysis) { 
                showError('ูุฑุฌู ุชุญููู ุงูุณูุฑุฉ ุงูุฐุงุชูุฉ ุฃููุงู ููุญุตูู ุนูู ุจูุงูุงุช ุงููุฑุดุญ.'); 
                return; 
            }
            hideMessages();
            document.getElementById('evaluationLoading').classList.add('show');
            document.getElementById('evaluationResult').innerHTML = '';
            
            try {
                // Pass the raw analysis text which should be structured according to resumeAnalysis prompt
                const evaluation = await callGeminiAPI(currentCandidate.fullAnalysis, 'candidateEvaluation');
                const formattedEvaluation = formatGeminiOutput(evaluation);

                const scoreText = extractInfoFromFormattedText(evaluation, 'compatibilityScore');
                const score = scoreText !== '-' ? parseInt(scoreText) : generateCompatibilityScore(evaluation); // Fallback
                const scoreClass = score >= 85 ? 'score-high' : score >= 70 ? 'score-medium' : 'score-low';
                const scoreIcon = score >= 85 ? '๐ข' : score >= 70 ? '๐ก' : '๐ด';
                
                document.getElementById('evaluationResult').innerHTML = `
                    <div class="compatibility-score ${scoreClass} mb-3">
                        ${scoreIcon} ูุณุจุฉ ุงูุชูุงูู ุงูููุฏุฑุฉ: ${score}%
                    </div>
                    <div class="output-box">${formattedEvaluation}</div>`;
                currentCandidate.evaluation = evaluation; // Store raw API response
                currentCandidate.compatibilityScore = score;
                showSuccess('ุชู ุชูููู ุงููุฑุดุญ ุจูุฌุงุญ.');
            } catch (error) {
                document.getElementById('evaluationResult').innerHTML = `<div class="alert alert-danger-custom">ุญุฏุซ ุฎุทุฃ ูู ุงูุชูููู: ${error.message}</div>`;
                showError('ูุดู ูู ุชูููู ุงููุฑุดุญ: ' + error.message);
            } finally {
                document.getElementById('evaluationLoading').classList.remove('show');
            }
        }

        function generateCompatibilityScore(evaluationText) { 
            let score = 70; 
            if (!evaluationText) return 60; // Default if no text
            if (evaluationText.includes('ููุชุงุฒ') || evaluationText.includes('ูุคูู ุฌุฏุง') || evaluationText.includes('ููุตู ุจู ุจุดุฏุฉ')) score += 20;
            else if (evaluationText.includes('ุฌูุฏ ุฌุฏุง') || evaluationText.includes('ููุตู ุจู')) score += 10;
            else if (evaluationText.includes('ููุจูู') || evaluationText.includes('ูุน ุจุนุถ ุงูุชุญูุธุงุช')) score += 0;
            else if (evaluationText.includes('ุถุนูู') || evaluationText.includes('ุบูุฑ ููุงุณุจ') || evaluationText.includes('ุบูุฑ ููุตู ุจู')) score -= 15;
            
            // Check for explicit percentages mentioned
            const explicitScoreMatch = evaluationText.match(/(\d+)%/);
            if (explicitScoreMatch && explicitScoreMatch[1]) {
                const explicitScore = parseInt(explicitScoreMatch[1]);
                if (explicitScore >= 0 && explicitScore <= 100) return explicitScore;
            }
            return Math.min(Math.max(Math.round(score), 40), 99); // Ensure score is within 40-99 range
        }

        async function generateQuestions() {
            const jobDescription = document.getElementById('jobDescription').value;
            if (!jobDescription.trim()) { showError('ูุฑุฌู ุฅุฏุฎุงู ูุตู ุงููุธููุฉ ุฃููุงู'); return; }
            hideMessages();
            document.getElementById('questionsLoading').classList.add('show');
            document.getElementById('questionsList').innerHTML = '';
            document.getElementById('questionsListOutput').style.display = 'none';


            try {
                const questionsText = await callGeminiAPI(jobDescription, 'questionGeneration');
                const formattedQuestions = formatGeminiOutput(questionsText); // Use formatter for potential Markdown
                
                // Simple check if questions were generated
                if (!questionsText || questionsText.trim().length < 20) { // Arbitrary length check
                    document.getElementById('questionsList').innerHTML = `<div class="list-group-item text-warning"><i class="fas fa-exclamation-triangle me-2"></i> ูู ูุชู ุชูููุฏ ุฃุณุฆูุฉ. ูุฏ ูููู ูุตู ุงููุธููุฉ ุบูุฑ ูุงูู ุฃู ุญุฏุซ ุฎุทุฃ.</div>`;
                } else {
                    document.getElementById('questionsList').innerHTML = formattedQuestions;
                    showSuccess('ุชู ุชูููุฏ ุงูุฃุณุฆูุฉ ุจูุฌุงุญ.');
                }
                document.getElementById('questionsListOutput').style.display = 'block';
            } catch (error) {
                document.getElementById('questionsList').innerHTML = `<div class="list-group-item text-danger"><i class="fas fa-times-circle me-2"></i> ุญุฏุซ ุฎุทุฃ: ${error.message}</div>`;
                showError('ูุดู ูู ุชูููุฏ ุงูุฃุณุฆูุฉ: ' + error.message);
                 document.getElementById('questionsListOutput').style.display = 'block';
            } finally {
                document.getElementById('questionsLoading').classList.remove('show');
            }
        }

        function initSpeechRecognition() {
            if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                recognition = new SpeechRecognition();
                recognition.lang = 'ar-SA';
                recognition.continuous = false; 
                recognition.interimResults = false;

                recognition.onstart = () => {
                    document.getElementById('voiceStatus').innerHTML = '<i class="fas fa-microphone me-1"></i> ุฌุงุฑู ุงูุงุณุชูุงุน...';
                    document.getElementById('voiceStatus').className = 'voice-status status-listening me-2 mb-2';
                    document.getElementById('audioWave').classList.add('show');
                };

                recognition.onresult = (event) => {
                    const transcript = event.results[0][0].transcript.trim();
                    if (transcript) handleVoiceInput(transcript);
                };

                recognition.onerror = (event) => {
                    console.error('Speech recognition error:', event.error);
                    let errorMsg = 'ุญุฏุซ ุฎุทุฃ ูู ุงูุชุนุฑู ุนูู ุงูุตูุช';
                    if (event.error === 'no-speech') errorMsg = 'ูู ูุชู ุงูุชูุงุท ุฃู ุตูุช. ูุฑุฌู ุงูุชุญุฏุซ ุจูุถูุญ.';
                    else if (event.error === 'audio-capture') errorMsg = 'ูุดููุฉ ูู ุงูุชูุงุท ุงูุตูุช. ุชุฃูุฏ ุฃู ุงููููุฑูููู ูุนูู.';
                    else if (event.error === 'not-allowed') errorMsg = 'ุชู ุฑูุถ ุฅุฐู ุงุณุชุฎุฏุงู ุงููููุฑูููู.';
                    showError(errorMsg);
                    if(isInterviewActive) stopVoiceInterview(true); // Stop if error occurs, maybe pass a flag
                };

                recognition.onend = () => {
                    document.getElementById('voiceStatus').innerHTML = '<i class="fas fa-microphone-slash me-1"></i> ูุชููู';
                    document.getElementById('voiceStatus').className = 'voice-status status-stopped me-2 mb-2';
                    document.getElementById('audioWave').classList.remove('show');
                    // If interview is still active and we are expecting more interaction, it might be restarted by askNextQuestionAndListen
                };
            } else {
                showError('ุงููุชุตูุญ ูุง ูุฏุนู ุฎุงุตูุฉ ุงูุชุนุฑู ุนูู ุงูุตูุช. ูุฑุฌู ุงุณุชุฎุฏุงู ูุชุตูุญ ุญุฏูุซ ูุซู Chrome ุฃู Edge.');
                document.getElementById('startInterviewBtn').disabled = true; // Disable if not supported
            }
        }
        
        function startVoiceInterview() {
            if (!recognition) {
                initSpeechRecognition();
                if (!recognition) { // Still no recognition after init
                    showError('ูุง ูููู ุจุฏุก ุงูููุงุจูุฉุ ุฎุงุตูุฉ ุงูุชุนุฑู ุนูู ุงูุตูุช ุบูุฑ ูุชุงุญุฉ ุฃู ูู ูุชู ุงูุณูุงุญ ุจูุง.');
                    return;
                }
            }
            
            isInterviewActive = true;
            currentQuestionIndex = 0;
            document.getElementById('startInterviewBtn').disabled = true;
            document.getElementById('stopInterviewBtn').disabled = false;
            document.getElementById('voiceChat').innerHTML = `<div class="ai-message"><i class="fas fa-robot me-1"></i> ูุฑุญุจุงู ุจู ูู ุงูููุงุจูุฉ ุงููุจุฏุฆูุฉ ุงูุฐููุฉ. ุณุฃุทุฑุญ ุนููู ${interviewQuestions.length} ุฃุณุฆูุฉ. ุงุณุชุนุฏ ููุณุคุงู ุงูุฃูู...</div>`;
            // Consider adding generated questions to the pool
            // For now, using the default 'interviewQuestions'
            setTimeout(() => askNextQuestionAndListen(), 2500);
            showSuccess('ุชู ุจุฏุก ุงูููุงุจูุฉ ุงูุตูุชูุฉ.');
        }

        function stopVoiceInterview(errorOccurred = false) {
            isInterviewActive = false;
            if (recognition) recognition.stop();
            document.getElementById('startInterviewBtn').disabled = false;
            document.getElementById('stopInterviewBtn').disabled = true;
            if (!errorOccurred) {
                addVoiceMessage('ุดูุฑุงู ูู ุนูู ุฅุฌุฑุงุก ุงูููุงุจูุฉ. ุณูุชู ูุฑุงุฌุนุฉ ุฅุฌุงุจุงุชู.', 'ai');
                showSuccess('ุชู ุฅููุงุก ุงูููุงุจูุฉ ุงูุตูุชูุฉ ุจูุฌุงุญ.');
            } else {
                 addVoiceMessage('ุชู ุฅููุงู ุงูููุงุจูุฉ ุจุณุจุจ ุฎุทุฃ.', 'ai');
            }
        }

        function askNextQuestionAndListen() {
            if (!isInterviewActive) return;

            if (currentQuestionIndex < interviewQuestions.length) {
                const question = `ุงูุณุคุงู ${currentQuestionIndex + 1}/${interviewQuestions.length}: ${interviewQuestions[currentQuestionIndex]}`;
                addVoiceMessage(question, 'ai');
                // currentQuestionIndex++; // Increment after asking and before listening for this question's answer
                
                if (recognition && isInterviewActive) {
                     try {
                        setTimeout(() => recognition.start(), 800); 
                     } catch(e) {
                        console.error("Error starting recognition:", e);
                        showError("ุฎุทุฃ ุนูุฏ ูุญุงููุฉ ุจุฏุก ุงูุงุณุชูุงุน. ุชุฃูุฏ ูู ุฃุฐููุงุช ุงููููุฑูููู.");
                        stopVoiceInterview(true);
                     }
                }
            } else {
                addVoiceMessage('ุชู ุงูุงูุชูุงุก ูู ุฌููุน ุงูุฃุณุฆูุฉ. ุดูุฑุงู ุฌุฒููุงู ูู ุนูู ููุชู ูุฅุฌุงุจุงุชู.', 'ai');
                stopVoiceInterview();
            }
        }
        
        async function handleVoiceInput(transcript) {
            addVoiceMessage(transcript, 'user');
            if (!isInterviewActive) return;

            const thinkingMsg = addVoiceMessage('<i class="fas fa-spinner fa-spin me-1"></i> ุฃููุฑ ูู ุฑุฏู...', 'ai', true);

            try {
                const currentQ = interviewQuestions[currentQuestionIndex];
                const promptForVoiceEval = `ุงูุณุคุงู ุงููุทุฑูุญ ุนูู ุงููุฑุดุญ: "${currentQ}"\nุฅุฌุงุจุฉ ุงููุฑุดุญ: "${transcript}"`;
                
                const response = await callGeminiAPI(promptForVoiceEval, 'voiceInterview');
                const formattedResponse = formatGeminiOutput(response);
                thinkingMsg.innerHTML = `<i class="fas fa-robot me-1"></i> ${formattedResponse}`; 
                
                currentQuestionIndex++; // Move to next question *after* processing current one
                setTimeout(() => askNextQuestionAndListen(), 2500); 
            } catch (error) {
                console.error("Error handling voice input AI call:", error);
                thinkingMsg.innerHTML = `<i class="fas fa-robot me-1"></i> ุดูุฑุงู ูุฅุฌุงุจุชู. ุฏุนูุง ููุชูู ููุณุคุงู ุงูุชุงูู. (ุญุฏุซ ุฎุทุฃ ุจุณูุท ูู ุงููุนุงูุฌุฉ)`;
                showError('ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ูุนุงูุฌุฉ ุฑุฏู ุงูุตูุชู: ' + error.message, 'errorMessage'); // Use main error display
                currentQuestionIndex++;
                setTimeout(() => askNextQuestionAndListen(), 2000);
            }
        }


        function addVoiceMessage(message, sender, isThinking = false) {
            const chatContainer = document.getElementById('voiceChat');
            const messageDiv = document.createElement('div');
            messageDiv.className = `chat-message ${sender}-message`;
            messageDiv.innerHTML = sender === 'ai' ? `<i class="fas fa-robot me-1"></i> ${message}` : `<i class="fas fa-user me-1"></i> ${message}`;
            chatContainer.appendChild(messageDiv);
            chatContainer.scrollTop = chatContainer.scrollHeight;
            if (isThinking) return messageDiv; 
        }


        async function sendChatMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            if (!message) return;
            addChatMessage(message, 'user');
            input.value = '';
            const typingDiv = addChatMessage('<i class="fas fa-spinner fa-spin me-1"></i> ุงููุณุงุนุฏ ุงูุฐูู ููุชุจ ุงูุขู...', 'ai', true);
            try {
                const response = await callGeminiAPI(message, 'chatAssistant');
                const formattedResponse = formatGeminiOutput(response);
                typingDiv.innerHTML = `<i class="fas fa-robot me-1"></i> ${formattedResponse}`;
            } catch (error) {
                console.error("Chatbot API error:", error);
                typingDiv.innerHTML = '<i class="fas fa-robot me-1"></i> ุนุฐุฑุงูุ ูุงุฌูุชูู ูุดููุฉ ูู ุงูุฑุฏ ุนูู ุงุณุชูุณุงุฑู ุงูุขู. ูุฑุฌู ุงููุญุงููุฉ ูุฑุฉ ุฃุฎุฑู ุจุนุฏ ูููู.';
                showError('ูุดู ูู ุงูุญุตูู ุนูู ุฑุฏ ูู ุงููุณุงุนุฏ ุงูุฐูู: ' + error.message);
            }
        }

        function addChatMessage(message, sender, isTyping = false) {
            const chatContainer = document.getElementById('chatContainer');
            const messageDiv = document.createElement('div');
            messageDiv.className = `chat-message ${sender}-message`;
            messageDiv.innerHTML = sender === 'ai' ? `<i class="fas fa-robot me-1"></i> ${message}` : `<i class="fas fa-user me-1"></i> ${message}`;
            chatContainer.appendChild(messageDiv);
            chatContainer.scrollTop = chatContainer.scrollHeight;
            if(isTyping) return messageDiv;
        }

        async function generateRecommendation() {
            if (!currentCandidate) { showError('ูุฑุฌู ุชุญููู ุงูุณูุฑุฉ ุงูุฐุงุชูุฉ ูุชูููู ุงููุฑุดุญ ุฃููุงู ูุชูููู ุชูุตูุฉ ุดุงููุฉ.'); return; }
            hideMessages();
            document.getElementById('recommendationLoading').classList.add('show');
            document.getElementById('recommendationOutput').innerHTML = '';
            try {
                // The finalRecommendation prompt is designed to take all candidate data implicitly through its structure
                // We need to ensure currentCandidate fields are up-to-date before calling this
                const recommendation = await callGeminiAPI(currentCandidate, 'finalRecommendation'); // Pass candidate object or constructed string
                const formattedRecommendation = formatGeminiOutput(recommendation);
                document.getElementById('recommendationOutput').innerHTML = formattedRecommendation;
                showSuccess('ุชู ุฅูุดุงุก ุงูุชูุตูุฉ ุงูููุงุฆูุฉ ุจูุฌุงุญ.');
            } catch (error) {
                document.getElementById('recommendationOutput').innerHTML = `<div class="alert alert-danger-custom">ุญุฏุซ ุฎุทุฃ: ${error.message}</div>`;
                showError('ูุดู ูู ุชูููุฏ ุงูุชูุตูุฉ ุงูููุงุฆูุฉ: ' + error.message);
            } finally {
                document.getElementById('recommendationLoading').classList.remove('show');
            }
        }

        document.getElementById('chatInput').addEventListener('keypress', (e) => { if (e.key === 'Enter') sendChatMessage(); });

        window.addEventListener('load', () => {
            initSpeechRecognition();
            document.querySelectorAll('.section-card, .header, .sidebar').forEach(el => {
                el.style.opacity = '0';
                el.style.transform = 'translateY(20px)';
                el.style.transition = 'opacity 0.6s ease-out, transform 0.6s ease-out';
            });

            let delay = 0;
            document.querySelectorAll('.header, .sidebar, .section-card').forEach(el => {
                setTimeout(() => {
                    el.style.opacity = '1';
                    el.style.transform = 'translateY(0)';
                }, delay);
                delay += 120; 
            });
        });
    </script>
</body>
</html>
